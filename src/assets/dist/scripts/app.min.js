!function e(t,n,r){function o(u,a){if(!n[u]){if(!t[u]){var c="function"==typeof require&&require;if(!a&&c)return c(u,!0);if(i)return i(u,!0);var l=new Error("Cannot find module '"+u+"'");throw l.code="MODULE_NOT_FOUND",l}var f=n[u]={exports:{}};t[u][0].call(f.exports,function(e){var n=t[u][1][e];return o(n?n:e)},f,f.exports,e,t,n,r)}return n[u].exports}for(var i="function"==typeof require&&require,u=0;u<r.length;u++)o(r[u]);return o}({1:[function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(n,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=null,u=function(){function e(){r(this,e),null!==i&&!1!=i instanceof this||(this.counters=new Map,this.events=new Map,this.moduleMap=new Map,i=this)}return o(e,[{key:"addModule",value:function(e,t){return this.moduleMap.set(e,t),this}},{key:"addCounter",value:function(e){var t=e.id,n=e.jsModule,r=e.jsObject,o=e.options,i=void 0===o?{}:o;return this.moduleMap.has(n)?(n=this.moduleMap.get(n),this.counters.set(t,new n(this,r,i)),this):this}},{key:"addEvent",value:function(e){var t=e.jsModule,n=e.type,r=e.options,o=void 0===r?{}:r;if(!this.moduleMap.has(t))return this;t=this.moduleMap.get(t);var i=this.events.has(n)?this.events.get(n):[];return i.push(new t(this,o)),this.events.set(n,i),this}},{key:"addCounters",value:function(e){var t=!0,n=!1,r=void 0;try{for(var o,i=e[Symbol.iterator]();!(t=(o=i.next()).done);t=!0){var u=o.value;this.addCounter(u)}}catch(a){n=!0,r=a}finally{try{!t&&i["return"]&&i["return"]()}finally{if(n)throw r}}return this}},{key:"addEvents",value:function(e){var t=!0,n=!1,r=void 0;try{for(var o,i=e[Symbol.iterator]();!(t=(o=i.next()).done);t=!0){var u=o.value;this.addEvent(u)}}catch(a){n=!0,r=a}finally{try{!t&&i["return"]&&i["return"]()}finally{if(n)throw r}}return this}},{key:"trigger",value:function(e,t){var n=this.events.has(e)?this.events.get(e):[],r=!0,o=!1,i=void 0;try{for(var u,a=n[Symbol.iterator]();!(r=(u=a.next()).done);r=!0){var c=u.value;c.trigger(t)}}catch(l){o=!0,i=l}finally{try{!r&&a["return"]&&a["return"]()}finally{if(o)throw i}}return this}}]),e}();n.UnionAnalytics=u},{}],2:[function(e,t,n){(function(t){"use strict";var n=e("./UnionAnalytics"),r=e("./counters/CounterGoogleAnalytics"),o=e("./counters/CounterYandexMetrika"),i=e("./counters/CounterPiwik"),u=e("./events/Click"),a=e("./events/Submit"),c=new n.UnionAnalytics;c.addModule("CounterGoogleAnalytics",r.CounterGoogleAnalytics),c.addModule("CounterYandexMetrika",o.CounterYandexMetrika),c.addModule("CounterPiwik",i.CounterPiwik),c.addModule("Click",u.Click),c.addModule("Submit",a.Submit),t.UnionAnalytics=c}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./UnionAnalytics":1,"./counters/CounterGoogleAnalytics":3,"./counters/CounterPiwik":5,"./counters/CounterYandexMetrika":6,"./events/Click":7,"./events/Submit":9}],3:[function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(n,"__esModule",{value:!0}),n.CounterGoogleAnalytics=void 0;var u=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a=function f(e,t,n){null===e&&(e=Function.prototype);var r=Object.getOwnPropertyDescriptor(e,t);if(void 0===r){var o=Object.getPrototypeOf(e);return null===o?void 0:f(o,t,n)}if("value"in r)return r.value;var i=r.get;if(void 0!==i)return i.call(n)},c=e("./CounterInterface"),l=function(e){function t(){return r(this,t),o(this,Object.getPrototypeOf(t).apply(this,arguments))}return i(t,e),u(t,[{key:"init",value:function(e){a(Object.getPrototypeOf(t.prototype),"init",this).call(this,e)}},{key:"resolveJsObject",value:function(e){return window[e]||a(Object.getPrototypeOf(t.prototype),"resolveJsObject",this).call(this,e)}},{key:"sendEvent",value:function(e,t,n){}}]),t}(c.CounterInterface);n.CounterGoogleAnalytics=l},{"./CounterInterface":4}],4:[function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(n,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=function(){function e(t,n,o){r(this,e),this.locator=t,this.jsObject=this.resolveJsObject(n),this.rawOptions=o,this.init(o)}return o(e,[{key:"init",value:function(e){}},{key:"resolveJsObject",value:function(e){return{}}},{key:"sendEvent",value:function(e,t,n){}}]),e}();n.CounterInterface=i},{}],5:[function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(n,"__esModule",{value:!0}),n.CounterPiwik=void 0;var u=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a=function f(e,t,n){null===e&&(e=Function.prototype);var r=Object.getOwnPropertyDescriptor(e,t);if(void 0===r){var o=Object.getPrototypeOf(e);return null===o?void 0:f(o,t,n)}if("value"in r)return r.value;var i=r.get;if(void 0!==i)return i.call(n)},c=e("./CounterInterface"),l=function(e){function t(){return r(this,t),o(this,Object.getPrototypeOf(t).apply(this,arguments))}return i(t,e),u(t,[{key:"init",value:function(e){a(Object.getPrototypeOf(t.prototype),"init",this).call(this,e)}},{key:"resolveJsObject",value:function(e){return window[e]||a(Object.getPrototypeOf(t.prototype),"resolveJsObject",this).call(this,e)}},{key:"sendEvent",value:function(e,t,n){}}]),t}(c.CounterInterface);n.CounterPiwik=l},{"./CounterInterface":4}],6:[function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(n,"__esModule",{value:!0}),n.CounterYandexMetrika=void 0;var u=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a=function f(e,t,n){null===e&&(e=Function.prototype);var r=Object.getOwnPropertyDescriptor(e,t);if(void 0===r){var o=Object.getPrototypeOf(e);return null===o?void 0:f(o,t,n)}if("value"in r)return r.value;var i=r.get;if(void 0!==i)return i.call(n)},c=e("./CounterInterface"),l=function(e){function t(){return r(this,t),o(this,Object.getPrototypeOf(t).apply(this,arguments))}return i(t,e),u(t,[{key:"init",value:function(e){a(Object.getPrototypeOf(t.prototype),"init",this).call(this,e)}},{key:"resolveJsObject",value:function(e){return window["yaCounter"+e]||a(Object.getPrototypeOf(t.prototype),"resolveJsObject",this).call(this,e)}},{key:"sendEvent",value:function(e,t,n){console.log(e)}}]),t}(c.CounterInterface);n.CounterYandexMetrika=l},{"./CounterInterface":4}],7:[function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(n,"__esModule",{value:!0}),n.Click=void 0;var u=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a=e("./EventInterface"),c=function(e){function t(){return r(this,t),o(this,Object.getPrototypeOf(t).apply(this,arguments))}return i(t,e),u(t,[{key:"handle",value:function(e){var t=!0,n=!1,r=void 0;try{for(var o,i=this.locator.counters.values()[Symbol.iterator]();!(t=(o=i.next()).done);t=!0){var u=o.value;u.sendEvent(e,{},{})}}catch(a){n=!0,r=a}finally{try{!t&&i["return"]&&i["return"]()}finally{if(n)throw r}}}},{key:"eventName",get:function(){return"click"}}]),t}(a.EventInterface);n.Click=c},{"./EventInterface":8}],8:[function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(n,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=function(){function e(t,n){r(this,e),this.locator=t,this.init(n),this.attachHandlers(n)}return o(e,[{key:"init",value:function(e){}},{key:"attachHandlers",value:function(e){var t=this,n=Object.prototype.hasOwnProperty;if(null!==e&&n.call(e,"selectors")){var r=!0,o=!1,i=void 0;try{for(var u,a=e.selectors[Symbol.iterator]();!(r=(u=a.next()).done);r=!0)for(var c=u.value,l=document.querySelectorAll(c),f=0;f<l.length;f++)l[f].addEventListener(this.eventName,function(e){return t.handle(e)})}catch(s){o=!0,i=s}finally{try{!r&&a["return"]&&a["return"]()}finally{if(o)throw i}}}}},{key:"handle",value:function(e){}},{key:"eventName",get:function(){return""}}]),e}();n.EventInterface=i},{}],9:[function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(n,"__esModule",{value:!0}),n.Submit=void 0;var u=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a=e("./EventInterface"),c=function(e){function t(){return r(this,t),o(this,Object.getPrototypeOf(t).apply(this,arguments))}return i(t,e),u(t,[{key:"handle",value:function(e){var t=!0,n=!1,r=void 0;try{for(var o,i=this.locator.counters.values()[Symbol.iterator]();!(t=(o=i.next()).done);t=!0){var u=o.value;u.sendEvent(e,{},{})}}catch(a){n=!0,r=a}finally{try{!t&&i["return"]&&i["return"]()}finally{if(n)throw r}}}},{key:"eventName",get:function(){return"submit"}}]),t}(a.EventInterface);n.Submit=c},{"./EventInterface":8}]},{},[2]);
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm5vZGVfbW9kdWxlcy9icm93c2VyLXBhY2svX3ByZWx1ZGUuanMiLCJhcHAuanMiLCJqcy9VbmlvbkFuYWx5dGljcy5qcyIsImpzL2FwcC5qcyIsImpzL2NvdW50ZXJzL0NvdW50ZXJHb29nbGVBbmFseXRpY3MuanMiLCJqcy9jb3VudGVycy9Db3VudGVySW50ZXJmYWNlLmpzIiwianMvY291bnRlcnMvQ291bnRlclBpd2lrLmpzIiwianMvY291bnRlcnMvQ291bnRlcllhbmRleE1ldHJpa2EuanMiLCJqcy9ldmVudHMvQ2xpY2suanMiLCJqcy9ldmVudHMvRXZlbnRJbnRlcmZhY2UuanMiLCJqcy9ldmVudHMvU3VibWl0LmpzIl0sIm5hbWVzIjpbImUiLCJ0IiwibiIsInIiLCJzIiwibyIsInUiLCJhIiwicmVxdWlyZSIsImkiLCJmIiwiRXJyb3IiLCJjb2RlIiwibCIsImV4cG9ydHMiLCJjYWxsIiwibGVuZ3RoIiwiMSIsIm1vZHVsZSIsIl9jbGFzc0NhbGxDaGVjayIsImluc3RhbmNlIiwiQ29uc3RydWN0b3IiLCJUeXBlRXJyb3IiLCJPYmplY3QiLCJkZWZpbmVQcm9wZXJ0eSIsInZhbHVlIiwiX2NyZWF0ZUNsYXNzIiwiZGVmaW5lUHJvcGVydGllcyIsInRhcmdldCIsInByb3BzIiwiZGVzY3JpcHRvciIsImVudW1lcmFibGUiLCJjb25maWd1cmFibGUiLCJ3cml0YWJsZSIsImtleSIsInByb3RvUHJvcHMiLCJzdGF0aWNQcm9wcyIsInByb3RvdHlwZSIsIlVuaW9uQW5hbHl0aWNzIiwidGhpcyIsImNvdW50ZXJzIiwiTWFwIiwiZXZlbnRzIiwibW9kdWxlTWFwIiwianNNb2R1bGUiLCJqc09iamVjdCIsInNldCIsIl9yZWYiLCJpZCIsIl9yZWYkb3B0aW9ucyIsIm9wdGlvbnMiLCJ1bmRlZmluZWQiLCJoYXMiLCJnZXQiLCJfcmVmMiIsInR5cGUiLCJfcmVmMiRvcHRpb25zIiwiX2FycmF5IiwicHVzaCIsImNvdW50ZXJzQXJyYXkiLCJfaXRlcmF0b3JOb3JtYWxDb21wbGV0aW9uIiwiX2RpZEl0ZXJhdG9yRXJyb3IiLCJfaXRlcmF0b3JFcnJvciIsIl9zdGVwIiwiX2l0ZXJhdG9yIiwiU3ltYm9sIiwiaXRlcmF0b3IiLCJuZXh0IiwiZG9uZSIsImNvdW50ZXIiLCJhZGRDb3VudGVyIiwiZXJyIiwiX2l0ZXJhdG9yTm9ybWFsQ29tcGxldGlvbjIiLCJfZGlkSXRlcmF0b3JFcnJvcjIiLCJfaXRlcmF0b3JFcnJvcjIiLCJfc3RlcDIiLCJfaXRlcmF0b3IyIiwiZXZlbnQiLCJhZGRFdmVudCIsInBhcmFtcyIsIl9pdGVyYXRvck5vcm1hbENvbXBsZXRpb24zIiwiX2RpZEl0ZXJhdG9yRXJyb3IzIiwiX2l0ZXJhdG9yRXJyb3IzIiwiX3N0ZXAzIiwiX2l0ZXJhdG9yMyIsInRyaWdnZXIiLCIyIiwiZ2xvYmFsIiwiX1VuaW9uQW5hbHl0aWNzIiwiX0NvdW50ZXJHb29nbGVBbmFseXRpY3MiLCJfQ291bnRlcllhbmRleE1ldHJpa2EiLCJfQ291bnRlclBpd2lrIiwiX0NsaWNrIiwiX1N1Ym1pdCIsInVhIiwiYWRkTW9kdWxlIiwiQ291bnRlckdvb2dsZUFuYWx5dGljcyIsIkNvdW50ZXJZYW5kZXhNZXRyaWthIiwiQ291bnRlclBpd2lrIiwiQ2xpY2siLCJTdWJtaXQiLCJzZWxmIiwid2luZG93IiwiLi9VbmlvbkFuYWx5dGljcyIsIi4vY291bnRlcnMvQ291bnRlckdvb2dsZUFuYWx5dGljcyIsIi4vY291bnRlcnMvQ291bnRlclBpd2lrIiwiLi9jb3VudGVycy9Db3VudGVyWWFuZGV4TWV0cmlrYSIsIi4vZXZlbnRzL0NsaWNrIiwiLi9ldmVudHMvU3VibWl0IiwiMyIsIl9wb3NzaWJsZUNvbnN0cnVjdG9yUmV0dXJuIiwiUmVmZXJlbmNlRXJyb3IiLCJfaW5oZXJpdHMiLCJzdWJDbGFzcyIsInN1cGVyQ2xhc3MiLCJjcmVhdGUiLCJjb25zdHJ1Y3RvciIsInNldFByb3RvdHlwZU9mIiwiX19wcm90b19fIiwiX2dldCIsIm9iamVjdCIsInByb3BlcnR5IiwicmVjZWl2ZXIiLCJGdW5jdGlvbiIsImRlc2MiLCJnZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IiLCJwYXJlbnQiLCJnZXRQcm90b3R5cGVPZiIsImdldHRlciIsIl9Db3VudGVySW50ZXJmYWNlMiIsIl9Db3VudGVySW50ZXJmYWNlIiwiYXBwbHkiLCJhcmd1bWVudHMiLCJuYW1lIiwiZGF0YSIsIkNvdW50ZXJJbnRlcmZhY2UiLCIuL0NvdW50ZXJJbnRlcmZhY2UiLCI0IiwibG9jYXRvciIsInJlc29sdmVKc09iamVjdCIsInJhd09wdGlvbnMiLCJpbml0IiwiNSIsIjYiLCJjb25zb2xlIiwibG9nIiwiNyIsIl9FdmVudEludGVyZmFjZTIiLCJfRXZlbnRJbnRlcmZhY2UiLCJ2YWx1ZXMiLCJzZW5kRXZlbnQiLCJFdmVudEludGVyZmFjZSIsIi4vRXZlbnRJbnRlcmZhY2UiLCI4IiwiYXR0YWNoSGFuZGxlcnMiLCJfdGhpcyIsImhhc093blByb3BlcnR5Iiwic2VsZWN0b3JzIiwic2VsZWN0b3IiLCJlbGVtZW50cyIsImRvY3VtZW50IiwicXVlcnlTZWxlY3RvckFsbCIsImFkZEV2ZW50TGlzdGVuZXIiLCJldmVudE5hbWUiLCJoYW5kbGUiLCI5Il0sIm1hcHBpbmdzIjoiQ0FBQSxRQUFBQSxHQUFBQyxFQUFBQyxFQUFBQyxHQUFBLFFBQUFDLEdBQUFDLEVBQUFDLEdBQUEsSUFBQUosRUFBQUcsR0FBQSxDQUFBLElBQUFKLEVBQUFJLEdBQUEsQ0FBQSxHQUFBRSxHQUFBLGtCQUFBQyxVQUFBQSxPQUFBLEtBQUFGLEdBQUFDLEVBQUEsTUFBQUEsR0FBQUYsR0FBQSxFQUFBLElBQUFJLEVBQUEsTUFBQUEsR0FBQUosR0FBQSxFQUFBLElBQUFLLEdBQUEsR0FBQUMsT0FBQSx1QkFBQU4sRUFBQSxJQUFBLE1BQUFLLEdBQUFFLEtBQUEsbUJBQUFGLEVBQUEsR0FBQUcsR0FBQVgsRUFBQUcsSUFBQVMsV0FBQWIsR0FBQUksR0FBQSxHQUFBVSxLQUFBRixFQUFBQyxRQUFBLFNBQUFkLEdBQUEsR0FBQUUs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QUFPLFVBQVVULEVBQWFjLEVBQVlDLEdBQWlKLE1BQTlIRCxJQUFZUixFQUFpQk4sRUFBWWdCLFVBQVdGLEdBQWlCQyxHQUFhVCxFQUFpQk4sRUFBYWUsR0FBcUJmLE1TdHJCaGlCOEgsRUFBQTNJLEVBQUEsb0JBRU00RixFVDhyQk8sU0FBVWdELEdBR25CLFFBQVNoRCxLQUdMLE1BRkFqRixHQUFnQm9CLEtBQU02RCxHQUVmVSxFQUEyQnZFLEtBQU1oQixPQUFPd0csZUFBZTNCLEdBQVErQixNQUFNNUYsS0FBTTZGLFlBNEN0RixNQWpEQXBCLEdBQVVaLEVBQVFnRCxHQVFsQjFILEVBQWEwRSxJQUNUbEUsSUFBSyxTQU9MVCxNQUFPLFNTcnNCSm9ELEdBQU8sR0FBQWpCLElBQUEsRUFBQUMsR0FBQSxFQUFBQyxFQUFBWCxNQUFBLEtBQ1YsSUFBQSxHQUFBWSxHQUFBQyxFQUFvQnpCLEtBQUttRyxRQUFRbEcsU0FBUzZHLFNBQTFDcEYsT0FBQUMsY0FBQU4sR0FBQUcsRUFBQUMsRUFBQUcsUUFBQUMsTUFBQVIsR0FBQSxFQUFvRCxDQUFBLEdBQTNDUyxHQUEyQ04sRUFBQXRDLEtBQ2hENEMsR0FBUWlGLFVBQVV6RSxVQUZaLE1BQUFOLEdBQUFWLEdBQUEsRUFBQUMsRUFBQVMsRUFBQSxRQUFBLEtBQUFYLEdBQUFJLEVBQUFBLFdBQUFBLEVBQUFBLFlBQUEsUUFBQSxHQUFBSCxFQUFBLEtBQUFDLFFUZ3VCVjVCLElBQUssWUFDTG1CLElBQUssV1N4dUJMLE1BQU8sYVQ2dUJKK0MsR0FDVCtDLEVBQWlCSSxlQUVuQnpJLEdTbHVCUXNGLE9BQUFBLElUb3VCTG9ELG1CQUFtQixTQUFTIiwiZmlsZSI6ImFwcC5qcyIsInNvdXJjZXNDb250ZW50IjpbIihmdW5jdGlvbiBlKHQsbixyKXtmdW5jdGlvbiBzKG8sdSl7aWYoIW5bb10pe2lmKCF0W29dKXt2YXIgYT10eXBlb2YgcmVxdWlyZT09XCJmdW5jdGlvblwiJiZyZXF1aXJlO2lmKCF1JiZhKXJldHVybiBhKG8sITApO2lmKGkpcmV0dXJuIGkobywhMCk7dmFyIGY9bmV3IEVycm9yKFwiQ2Fubm90IGZpbmQgbW9kdWxlICdcIitvK1wiJ1wiKTt0aHJvdyBmLmNvZGU9XCJNT0RVTEVfTk9UX0ZPVU5EXCIsZn12YXIgbD1uW29dPXtleHBvcnRzOnt9fTt0W29dWzBdLmNhbGwobC5leHBvcnRzLGZ1bmN0aW9uKGUpe3ZhciBuPXRbb11bMV1bZV07cmV0dXJuIHMobj9uOmUpfSxsLGwuZXhwb3J0cyxlLHQsbixyKX1yZXR1cm4gbltvXS5leHBvcnRzfXZhciBpPXR5cGVvZiByZXF1aXJlPT1cImZ1bmN0aW9uXCImJnJlcXVpcmU7Zm9yKHZhciBvPTA7bzxyLmxlbmd0aDtvKyspcyhyW29dKTtyZXR1cm4gc30pIiwiKGZ1bmN0aW9uIGUodCxuLHIpe2Z1bmN0aW9uIHMobyx1KXtpZighbltvXSl7aWYoIXRbb10pe3ZhciBhPXR5cGVvZiByZXF1aXJlPT1cImZ1bmN0aW9uXCImJnJlcXVpcmU7aWYoIXUmJmEpcmV0dXJuIGEobywhMCk7aWYoaSlyZXR1cm4gaShvLCEwKTt2YXIgZj1uZXcgRXJyb3IoXCJDYW5ub3QgZmluZCBtb2R1bGUgJ1wiK28rXCInXCIpO3Rocm93IGYuY29kZT1cIk1PRFVMRV9OT1RfRk9VTkRcIixmfXZhciBsPW5bb109e2V4cG9ydHM6e319O3Rbb11bMF0uY2FsbChsLmV4cG9ydHMsZnVuY3Rpb24oZSl7dmFyIG49dFtvXVsxXVtlXTtyZXR1cm4gcyhuP246ZSl9LGwsbC5leHBvcnRzLGUsdCxuLHIpfXJldHVybiBuW29dLmV4cG9ydHN9dmFyIGk9dHlwZW9mIHJlcXVpcmU9PVwiZnVuY3Rpb25cIiYmcmVxdWlyZTtmb3IodmFyIG89MDtvPHIubGVuZ3RoO28rKylzKHJbb10pO3JldHVybiBzfSkoezE6W2Z1bmN0aW9uKHJlcXVpcmUsbW9kdWxlLGV4cG9ydHMpe1xuXCJ1c2Ugc3RyaWN0XCI7XG5cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwge1xuICAgIHZhbHVlOiB0cnVlXG59KTtcblxudmFyIF9jcmVhdGVDbGFzcyA9IGZ1bmN0aW9uICgpIHsgZnVuY3Rpb24gZGVmaW5lUHJvcGVydGllcyh0YXJnZXQsIHByb3BzKSB7IGZvciAodmFyIGkgPSAwOyBpIDwgcHJvcHMubGVuZ3RoOyBpKyspIHsgdmFyIGRlc2NyaXB0b3IgPSBwcm9wc1tpXTsgZGVzY3JpcHRvci5lbnVtZXJhYmxlID0gZGVzY3JpcHRvci5lbnVtZXJhYmxlIHx8IGZhbHNlOyBkZXNjcmlwdG9yLmNvbmZpZ3VyYWJsZSA9IHRydWU7IGlmIChcInZhbHVlXCIgaW4gZGVzY3JpcHRvcikgZGVzY3JpcHRvci53cml0YWJsZSA9IHRydWU7IE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIGRlc2NyaXB0b3Iua2V5LCBkZXNjcmlwdG9yKTsgfSB9IHJldHVybiBmdW5jdGlvbiAoQ29uc3RydWN0b3IsIHByb3RvUHJvcHMsIHN0YXRpY1Byb3BzKSB7IGlmIChwcm90b1Byb3BzKSBkZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLnByb3RvdHlwZSwgcHJvdG9Qcm9wcyk7IGlmIChzdGF0aWNQcm9wcykgZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvciwgc3RhdGljUHJvcHMpOyByZXR1cm4gQ29uc3RydWN0b3I7IH07IH0oKTtcblxuZnVuY3Rpb24gX2NsYXNzQ2FsbENoZWNrKGluc3RhbmNlLCBDb25zdHJ1Y3RvcikgeyBpZiAoIShpbnN0YW5jZSBpbnN0YW5jZW9mIENvbnN0cnVjdG9yKSkgeyB0aHJvdyBuZXcgVHlwZUVycm9yKFwiQ2Fubm90IGNhbGwgYSBjbGFzcyBhcyBhIGZ1bmN0aW9uXCIpOyB9IH1cblxudmFyIGluc3RhbmNlID0gbnVsbDtcblxudmFyIFVuaW9uQW5hbHl0aWNzID0gZnVuY3Rpb24gKCkge1xuICAgIC8qKlxuICAgICAqIFNpbmdsZXRvblxuICAgICAqIEByZXR1cm4geyp9XG4gICAgICovXG5cbiAgICBmdW5jdGlvbiBVbmlvbkFuYWx5dGljcygpIHtcbiAgICAgICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIFVuaW9uQW5hbHl0aWNzKTtcblxuICAgICAgICBpZiAobnVsbCA9PT0gaW5zdGFuY2UgfHwgZmFsc2UgPT09IGluc3RhbmNlIGluc3RhbmNlb2YgdGhpcykge1xuICAgICAgICAgICAgdGhpcy5jb3VudGVycyA9IG5ldyBNYXAoKTtcbiAgICAgICAgICAgIHRoaXMuZXZlbnRzID0gbmV3IE1hcCgpO1xuICAgICAgICAgICAgdGhpcy5tb2R1bGVNYXAgPSBuZXcgTWFwKCk7XG4gICAgICAgICAgICBpbnN0YW5jZSA9IHRoaXM7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBBZGQgbW9kdWxlXG4gICAgICogQHBhcmFtIGpzTW9kdWxlXG4gICAgICogQHBhcmFtIGpzT2JqZWN0XG4gICAgICogQHJldHVybiB7VW5pb25BbmFseXRpY3N9XG4gICAgICovXG5cblxuICAgIF9jcmVhdGVDbGFzcyhVbmlvbkFuYWx5dGljcywgW3tcbiAgICAgICAga2V5OiBcImFkZE1vZHVsZVwiLFxuICAgICAgICB2YWx1ZTogZnVuY3Rpb24gYWRkTW9kdWxlKGpzTW9kdWxlLCBqc09iamVjdCkge1xuICAgICAgICAgICAgdGhpcy5tb2R1bGVNYXAuc2V0KGpzTW9kdWxlLCBqc09iamVjdCk7XG5cbiAgICAgICAgICAgIHJldHVybiB0aGlzO1xuICAgICAgICB9XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIEFkZCBjb3VudGVyXG4gICAgICAgICAqIEBwYXJhbSBpZFxuICAgICAgICAgKiBAcGFyYW0ganNNb2R1bGVcbiAgICAgICAgICogQHBhcmFtIGpzT2JqZWN0XG4gICAgICAgICAqIEBwYXJhbSBvcHRpb25zXG4gICAgICAgICAqIEByZXR1cm4ge1VuaW9uQW5hbHl0aWNzfVxuICAgICAgICAgKi9cblxuICAgIH0sIHtcbiAgICAgICAga2V5OiBcImFkZENvdW50ZXJcIixcbiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGFkZENvdW50ZXIoX3JlZikge1xuICAgICAgICAgICAgdmFyIGlkID0gX3JlZi5pZDtcbiAgICAgICAgICAgIHZhciBqc01vZHVsZSA9IF9yZWYuanNNb2R1bGU7XG4gICAgICAgICAgICB2YXIganNPYmplY3QgPSBfcmVmLmpzT2JqZWN0O1xuICAgICAgICAgICAgdmFyIF9yZWYkb3B0aW9ucyA9IF9yZWYub3B0aW9ucztcbiAgICAgICAgICAgIHZhciBvcHRpb25zID0gX3JlZiRvcHRpb25zID09PSB1bmRlZmluZWQgPyB7fSA6IF9yZWYkb3B0aW9ucztcblxuICAgICAgICAgICAgaWYgKCF0aGlzLm1vZHVsZU1hcC5oYXMoanNNb2R1bGUpKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBqc01vZHVsZSA9IHRoaXMubW9kdWxlTWFwLmdldChqc01vZHVsZSk7XG4gICAgICAgICAgICB0aGlzLmNvdW50ZXJzLnNldChpZCwgbmV3IGpzTW9kdWxlKHRoaXMsIGpzT2JqZWN0LCBvcHRpb25zKSk7XG5cbiAgICAgICAgICAgIHJldHVybiB0aGlzO1xuICAgICAgICB9XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIEFkZCBldmVudFxuICAgICAgICAgKiBAcGFyYW0ganNNb2R1bGVcbiAgICAgICAgICogQHBhcmFtIHR5cGVcbiAgICAgICAgICogQHBhcmFtIG9wdGlvbnNcbiAgICAgICAgICogQHJldHVybiB7VW5pb25BbmFseXRpY3N9XG4gICAgICAgICAqL1xuXG4gICAgfSwge1xuICAgICAgICBrZXk6IFwiYWRkRXZlbnRcIixcbiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGFkZEV2ZW50KF9yZWYyKSB7XG4gICAgICAgICAgICB2YXIganNNb2R1bGUgPSBfcmVmMi5qc01vZHVsZTtcbiAgICAgICAgICAgIHZhciB0eXBlID0gX3JlZjIudHlwZTtcbiAgICAgICAgICAgIHZhciBfcmVmMiRvcHRpb25zID0gX3JlZjIub3B0aW9ucztcbiAgICAgICAgICAgIHZhciBvcHRpb25zID0gX3JlZjIkb3B0aW9ucyA9PT0gdW5kZWZpbmVkID8ge30gOiBfcmVmMiRvcHRpb25zO1xuXG4gICAgICAgICAgICBpZiAoIXRoaXMubW9kdWxlTWFwLmhhcyhqc01vZHVsZSkpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGpzTW9kdWxlID0gdGhpcy5tb2R1bGVNYXAuZ2V0KGpzTW9kdWxlKTtcblxuICAgICAgICAgICAgdmFyIF9hcnJheSA9IHRoaXMuZXZlbnRzLmhhcyh0eXBlKSA/IHRoaXMuZXZlbnRzLmdldCh0eXBlKSA6IFtdO1xuICAgICAgICAgICAgX2FycmF5LnB1c2gobmV3IGpzTW9kdWxlKHRoaXMsIG9wdGlvbnMpKTtcbiAgICAgICAgICAgIHRoaXMuZXZlbnRzLnNldCh0eXBlLCBfYXJyYXkpO1xuXG4gICAgICAgICAgICByZXR1cm4gdGhpcztcbiAgICAgICAgfVxuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBBZGQgY291bnRlcnNcbiAgICAgICAgICogQHBhcmFtIGNvdW50ZXJzQXJyYXlcbiAgICAgICAgICogQHJldHVybiB7VW5pb25BbmFseXRpY3N9XG4gICAgICAgICAqL1xuXG4gICAgfSwge1xuICAgICAgICBrZXk6IFwiYWRkQ291bnRlcnNcIixcbiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGFkZENvdW50ZXJzKGNvdW50ZXJzQXJyYXkpIHtcbiAgICAgICAgICAgIHZhciBfaXRlcmF0b3JOb3JtYWxDb21wbGV0aW9uID0gdHJ1ZTtcbiAgICAgICAgICAgIHZhciBfZGlkSXRlcmF0b3JFcnJvciA9IGZhbHNlO1xuICAgICAgICAgICAgdmFyIF9pdGVyYXRvckVycm9yID0gdW5kZWZpbmVkO1xuXG4gICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgIGZvciAodmFyIF9pdGVyYXRvciA9IGNvdW50ZXJzQXJyYXlbU3ltYm9sLml0ZXJhdG9yXSgpLCBfc3RlcDsgIShfaXRlcmF0b3JOb3JtYWxDb21wbGV0aW9uID0gKF9zdGVwID0gX2l0ZXJhdG9yLm5leHQoKSkuZG9uZSk7IF9pdGVyYXRvck5vcm1hbENvbXBsZXRpb24gPSB0cnVlKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBjb3VudGVyID0gX3N0ZXAudmFsdWU7XG5cbiAgICAgICAgICAgICAgICAgICAgdGhpcy5hZGRDb3VudGVyKGNvdW50ZXIpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0gY2F0Y2ggKGVycikge1xuICAgICAgICAgICAgICAgIF9kaWRJdGVyYXRvckVycm9yID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICBfaXRlcmF0b3JFcnJvciA9IGVycjtcbiAgICAgICAgICAgIH0gZmluYWxseSB7XG4gICAgICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKCFfaXRlcmF0b3JOb3JtYWxDb21wbGV0aW9uICYmIF9pdGVyYXRvci5yZXR1cm4pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIF9pdGVyYXRvci5yZXR1cm4oKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0gZmluYWxseSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChfZGlkSXRlcmF0b3JFcnJvcikge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhyb3cgX2l0ZXJhdG9yRXJyb3I7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHJldHVybiB0aGlzO1xuICAgICAgICB9XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIEFkZCBldmVudHNcbiAgICAgICAgICogQHBhcmFtIGV2ZW50c1xuICAgICAgICAgKiBAcmV0dXJuIHtVbmlvbkFuYWx5dGljc31cbiAgICAgICAgICovXG5cbiAgICB9LCB7XG4gICAgICAgIGtleTogXCJhZGRFdmVudHNcIixcbiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIGFkZEV2ZW50cyhldmVudHMpIHtcbiAgICAgICAgICAgIHZhciBfaXRlcmF0b3JOb3JtYWxDb21wbGV0aW9uMiA9IHRydWU7XG4gICAgICAgICAgICB2YXIgX2RpZEl0ZXJhdG9yRXJyb3IyID0gZmFsc2U7XG4gICAgICAgICAgICB2YXIgX2l0ZXJhdG9yRXJyb3IyID0gdW5kZWZpbmVkO1xuXG4gICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgIGZvciAodmFyIF9pdGVyYXRvcjIgPSBldmVudHNbU3ltYm9sLml0ZXJhdG9yXSgpLCBfc3RlcDI7ICEoX2l0ZXJhdG9yTm9ybWFsQ29tcGxldGlvbjIgPSAoX3N0ZXAyID0gX2l0ZXJhdG9yMi5uZXh0KCkpLmRvbmUpOyBfaXRlcmF0b3JOb3JtYWxDb21wbGV0aW9uMiA9IHRydWUpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGV2ZW50ID0gX3N0ZXAyLnZhbHVlO1xuXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuYWRkRXZlbnQoZXZlbnQpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0gY2F0Y2ggKGVycikge1xuICAgICAgICAgICAgICAgIF9kaWRJdGVyYXRvckVycm9yMiA9IHRydWU7XG4gICAgICAgICAgICAgICAgX2l0ZXJhdG9yRXJyb3IyID0gZXJyO1xuICAgICAgICAgICAgfSBmaW5hbGx5IHtcbiAgICAgICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgICAgICBpZiAoIV9pdGVyYXRvck5vcm1hbENvbXBsZXRpb24yICYmIF9pdGVyYXRvcjIucmV0dXJuKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBfaXRlcmF0b3IyLnJldHVybigpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSBmaW5hbGx5IHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKF9kaWRJdGVyYXRvckVycm9yMikge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhyb3cgX2l0ZXJhdG9yRXJyb3IyO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICByZXR1cm4gdGhpcztcbiAgICAgICAgfVxuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBUcmlnZ2VyIGFuIGV2ZW50XG4gICAgICAgICAqIEBwYXJhbSB0eXBlXG4gICAgICAgICAqIEBwYXJhbSBwYXJhbXNcbiAgICAgICAgICogQHJldHVybiB7VW5pb25BbmFseXRpY3N9XG4gICAgICAgICAqL1xuXG4gICAgfSwge1xuICAgICAgICBrZXk6IFwidHJpZ2dlclwiLFxuICAgICAgICB2YWx1ZTogZnVuY3Rpb24gdHJpZ2dlcih0eXBlLCBwYXJhbXMpIHtcbiAgICAgICAgICAgIHZhciBfYXJyYXkgPSB0aGlzLmV2ZW50cy5oYXModHlwZSkgPyB0aGlzLmV2ZW50cy5nZXQodHlwZSkgOiBbXTtcbiAgICAgICAgICAgIHZhciBfaXRlcmF0b3JOb3JtYWxDb21wbGV0aW9uMyA9IHRydWU7XG4gICAgICAgICAgICB2YXIgX2RpZEl0ZXJhdG9yRXJyb3IzID0gZmFsc2U7XG4gICAgICAgICAgICB2YXIgX2l0ZXJhdG9yRXJyb3IzID0gdW5kZWZpbmVkO1xuXG4gICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgIGZvciAodmFyIF9pdGVyYXRvcjMgPSBfYXJyYXlbU3ltYm9sLml0ZXJhdG9yXSgpLCBfc3RlcDM7ICEoX2l0ZXJhdG9yTm9ybWFsQ29tcGxldGlvbjMgPSAoX3N0ZXAzID0gX2l0ZXJhdG9yMy5uZXh0KCkpLmRvbmUpOyBfaXRlcmF0b3JOb3JtYWxDb21wbGV0aW9uMyA9IHRydWUpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGV2ZW50ID0gX3N0ZXAzLnZhbHVlO1xuXG4gICAgICAgICAgICAgICAgICAgIGV2ZW50LnRyaWdnZXIocGFyYW1zKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9IGNhdGNoIChlcnIpIHtcbiAgICAgICAgICAgICAgICBfZGlkSXRlcmF0b3JFcnJvcjMgPSB0cnVlO1xuICAgICAgICAgICAgICAgIF9pdGVyYXRvckVycm9yMyA9IGVycjtcbiAgICAgICAgICAgIH0gZmluYWxseSB7XG4gICAgICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKCFfaXRlcmF0b3JOb3JtYWxDb21wbGV0aW9uMyAmJiBfaXRlcmF0b3IzLnJldHVybikge1xuICAgICAgICAgICAgICAgICAgICAgICAgX2l0ZXJhdG9yMy5yZXR1cm4oKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0gZmluYWxseSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChfZGlkSXRlcmF0b3JFcnJvcjMpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRocm93IF9pdGVyYXRvckVycm9yMztcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgICAgIH1cbiAgICB9XSk7XG5cbiAgICByZXR1cm4gVW5pb25BbmFseXRpY3M7XG59KCk7XG5cbmV4cG9ydHMuVW5pb25BbmFseXRpY3MgPSBVbmlvbkFuYWx5dGljcztcblxufSx7fV0sMjpbZnVuY3Rpb24ocmVxdWlyZSxtb2R1bGUsZXhwb3J0cyl7XG4oZnVuY3Rpb24gKGdsb2JhbCl7XG4ndXNlIHN0cmljdCc7XG5cbnZhciBfVW5pb25BbmFseXRpY3MgPSByZXF1aXJlKCcuL1VuaW9uQW5hbHl0aWNzJyk7XG5cbnZhciBfQ291bnRlckdvb2dsZUFuYWx5dGljcyA9IHJlcXVpcmUoJy4vY291bnRlcnMvQ291bnRlckdvb2dsZUFuYWx5dGljcycpO1xuXG52YXIgX0NvdW50ZXJZYW5kZXhNZXRyaWthID0gcmVxdWlyZSgnLi9jb3VudGVycy9Db3VudGVyWWFuZGV4TWV0cmlrYScpO1xuXG52YXIgX0NvdW50ZXJQaXdpayA9IHJlcXVpcmUoJy4vY291bnRlcnMvQ291bnRlclBpd2lrJyk7XG5cbnZhciBfQ2xpY2sgPSByZXF1aXJlKCcuL2V2ZW50cy9DbGljaycpO1xuXG52YXIgX1N1Ym1pdCA9IHJlcXVpcmUoJy4vZXZlbnRzL1N1Ym1pdCcpO1xuXG4vL2ltcG9ydCB7SW50ZW50QW5hbHl0aWNzfSBmcm9tICcuL0ludGVudEFuYWx5dGljcyc7XG5cblxudmFyIHVhID0gbmV3IF9VbmlvbkFuYWx5dGljcy5VbmlvbkFuYWx5dGljcygpO1xudWEuYWRkTW9kdWxlKCdDb3VudGVyR29vZ2xlQW5hbHl0aWNzJywgX0NvdW50ZXJHb29nbGVBbmFseXRpY3MuQ291bnRlckdvb2dsZUFuYWx5dGljcyk7XG51YS5hZGRNb2R1bGUoJ0NvdW50ZXJZYW5kZXhNZXRyaWthJywgX0NvdW50ZXJZYW5kZXhNZXRyaWthLkNvdW50ZXJZYW5kZXhNZXRyaWthKTtcbnVhLmFkZE1vZHVsZSgnQ291bnRlclBpd2lrJywgX0NvdW50ZXJQaXdpay5Db3VudGVyUGl3aWspO1xudWEuYWRkTW9kdWxlKCdDbGljaycsIF9DbGljay5DbGljayk7XG51YS5hZGRNb2R1bGUoJ1N1Ym1pdCcsIF9TdWJtaXQuU3VibWl0KTtcblxuLy9nbG9iYWwuaW50ZW50QW5hbHl0aWNzID0gbmV3IEludGVudEFuYWx5dGljcygpO1xuZ2xvYmFsLlVuaW9uQW5hbHl0aWNzID0gdWE7XG5cbn0pLmNhbGwodGhpcyx0eXBlb2YgZ2xvYmFsICE9PSBcInVuZGVmaW5lZFwiID8gZ2xvYmFsIDogdHlwZW9mIHNlbGYgIT09IFwidW5kZWZpbmVkXCIgPyBzZWxmIDogdHlwZW9mIHdpbmRvdyAhPT0gXCJ1bmRlZmluZWRcIiA/IHdpbmRvdyA6IHt9KVxuXG59LHtcIi4vVW5pb25BbmFseXRpY3NcIjoxLFwiLi9jb3VudGVycy9Db3VudGVyR29vZ2xlQW5hbHl0aWNzXCI6MyxcIi4vY291bnRlcnMvQ291bnRlclBpd2lrXCI6NSxcIi4vY291bnRlcnMvQ291bnRlcllhbmRleE1ldHJpa2FcIjo2LFwiLi9ldmVudHMvQ2xpY2tcIjo3LFwiLi9ldmVudHMvU3VibWl0XCI6OX1dLDM6W2Z1bmN0aW9uKHJlcXVpcmUsbW9kdWxlLGV4cG9ydHMpe1xuJ3VzZSBzdHJpY3QnO1xuXG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHtcbiAgICB2YWx1ZTogdHJ1ZVxufSk7XG5leHBvcnRzLkNvdW50ZXJHb29nbGVBbmFseXRpY3MgPSB1bmRlZmluZWQ7XG5cbnZhciBfY3JlYXRlQ2xhc3MgPSBmdW5jdGlvbiAoKSB7IGZ1bmN0aW9uIGRlZmluZVByb3BlcnRpZXModGFyZ2V0LCBwcm9wcykgeyBmb3IgKHZhciBpID0gMDsgaSA8IHByb3BzLmxlbmd0aDsgaSsrKSB7IHZhciBkZXNjcmlwdG9yID0gcHJvcHNbaV07IGRlc2NyaXB0b3IuZW51bWVyYWJsZSA9IGRlc2NyaXB0b3IuZW51bWVyYWJsZSB8fCBmYWxzZTsgZGVzY3JpcHRvci5jb25maWd1cmFibGUgPSB0cnVlOyBpZiAoXCJ2YWx1ZVwiIGluIGRlc2NyaXB0b3IpIGRlc2NyaXB0b3Iud3JpdGFibGUgPSB0cnVlOyBPYmplY3QuZGVmaW5lUHJvcGVydHkodGFyZ2V0LCBkZXNjcmlwdG9yLmtleSwgZGVzY3JpcHRvcik7IH0gfSByZXR1cm4gZnVuY3Rpb24gKENvbnN0cnVjdG9yLCBwcm90b1Byb3BzLCBzdGF0aWNQcm9wcykgeyBpZiAocHJvdG9Qcm9wcykgZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvci5wcm90b3R5cGUsIHByb3RvUHJvcHMpOyBpZiAoc3RhdGljUHJvcHMpIGRlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IsIHN0YXRpY1Byb3BzKTsgcmV0dXJuIENvbnN0cnVjdG9yOyB9OyB9KCk7XG5cbnZhciBfZ2V0ID0gZnVuY3Rpb24gZ2V0KG9iamVjdCwgcHJvcGVydHksIHJlY2VpdmVyKSB7IGlmIChvYmplY3QgPT09IG51bGwpIG9iamVjdCA9IEZ1bmN0aW9uLnByb3RvdHlwZTsgdmFyIGRlc2MgPSBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKG9iamVjdCwgcHJvcGVydHkpOyBpZiAoZGVzYyA9PT0gdW5kZWZpbmVkKSB7IHZhciBwYXJlbnQgPSBPYmplY3QuZ2V0UHJvdG90eXBlT2Yob2JqZWN0KTsgaWYgKHBhcmVudCA9PT0gbnVsbCkgeyByZXR1cm4gdW5kZWZpbmVkOyB9IGVsc2UgeyByZXR1cm4gZ2V0KHBhcmVudCwgcHJvcGVydHksIHJlY2VpdmVyKTsgfSB9IGVsc2UgaWYgKFwidmFsdWVcIiBpbiBkZXNjKSB7IHJldHVybiBkZXNjLnZhbHVlOyB9IGVsc2UgeyB2YXIgZ2V0dGVyID0gZGVzYy5nZXQ7IGlmIChnZXR0ZXIgPT09IHVuZGVmaW5lZCkgeyByZXR1cm4gdW5kZWZpbmVkOyB9IHJldHVybiBnZXR0ZXIuY2FsbChyZWNlaXZlcik7IH0gfTtcblxudmFyIF9Db3VudGVySW50ZXJmYWNlMiA9IHJlcXVpcmUoJy4vQ291bnRlckludGVyZmFjZScpO1xuXG5mdW5jdGlvbiBfY2xhc3NDYWxsQ2hlY2soaW5zdGFuY2UsIENvbnN0cnVjdG9yKSB7IGlmICghKGluc3RhbmNlIGluc3RhbmNlb2YgQ29uc3RydWN0b3IpKSB7IHRocm93IG5ldyBUeXBlRXJyb3IoXCJDYW5ub3QgY2FsbCBhIGNsYXNzIGFzIGEgZnVuY3Rpb25cIik7IH0gfVxuXG5mdW5jdGlvbiBfcG9zc2libGVDb25zdHJ1Y3RvclJldHVybihzZWxmLCBjYWxsKSB7IGlmICghc2VsZikgeyB0aHJvdyBuZXcgUmVmZXJlbmNlRXJyb3IoXCJ0aGlzIGhhc24ndCBiZWVuIGluaXRpYWxpc2VkIC0gc3VwZXIoKSBoYXNuJ3QgYmVlbiBjYWxsZWRcIik7IH0gcmV0dXJuIGNhbGwgJiYgKHR5cGVvZiBjYWxsID09PSBcIm9iamVjdFwiIHx8IHR5cGVvZiBjYWxsID09PSBcImZ1bmN0aW9uXCIpID8gY2FsbCA6IHNlbGY7IH1cblxuZnVuY3Rpb24gX2luaGVyaXRzKHN1YkNsYXNzLCBzdXBlckNsYXNzKSB7IGlmICh0eXBlb2Ygc3VwZXJDbGFzcyAhPT0gXCJmdW5jdGlvblwiICYmIHN1cGVyQ2xhc3MgIT09IG51bGwpIHsgdGhyb3cgbmV3IFR5cGVFcnJvcihcIlN1cGVyIGV4cHJlc3Npb24gbXVzdCBlaXRoZXIgYmUgbnVsbCBvciBhIGZ1bmN0aW9uLCBub3QgXCIgKyB0eXBlb2Ygc3VwZXJDbGFzcyk7IH0gc3ViQ2xhc3MucHJvdG90eXBlID0gT2JqZWN0LmNyZWF0ZShzdXBlckNsYXNzICYmIHN1cGVyQ2xhc3MucHJvdG90eXBlLCB7IGNvbnN0cnVjdG9yOiB7IHZhbHVlOiBzdWJDbGFzcywgZW51bWVyYWJsZTogZmFsc2UsIHdyaXRhYmxlOiB0cnVlLCBjb25maWd1cmFibGU6IHRydWUgfSB9KTsgaWYgKHN1cGVyQ2xhc3MpIE9iamVjdC5zZXRQcm90b3R5cGVPZiA/IE9iamVjdC5zZXRQcm90b3R5cGVPZihzdWJDbGFzcywgc3VwZXJDbGFzcykgOiBzdWJDbGFzcy5fX3Byb3RvX18gPSBzdXBlckNsYXNzOyB9XG5cbnZhciBDb3VudGVyR29vZ2xlQW5hbHl0aWNzID0gZnVuY3Rpb24gKF9Db3VudGVySW50ZXJmYWNlKSB7XG4gICAgX2luaGVyaXRzKENvdW50ZXJHb29nbGVBbmFseXRpY3MsIF9Db3VudGVySW50ZXJmYWNlKTtcblxuICAgIGZ1bmN0aW9uIENvdW50ZXJHb29nbGVBbmFseXRpY3MoKSB7XG4gICAgICAgIF9jbGFzc0NhbGxDaGVjayh0aGlzLCBDb3VudGVyR29vZ2xlQW5hbHl0aWNzKTtcblxuICAgICAgICByZXR1cm4gX3Bvc3NpYmxlQ29uc3RydWN0b3JSZXR1cm4odGhpcywgT2JqZWN0LmdldFByb3RvdHlwZU9mKENvdW50ZXJHb29nbGVBbmFseXRpY3MpLmFwcGx5KHRoaXMsIGFyZ3VtZW50cykpO1xuICAgIH1cblxuICAgIF9jcmVhdGVDbGFzcyhDb3VudGVyR29vZ2xlQW5hbHl0aWNzLCBbe1xuICAgICAgICBrZXk6ICdpbml0JyxcblxuICAgICAgICAvKipcbiAgICAgICAgICogQHBhcmFtIG9wdGlvbnNcbiAgICAgICAgICovXG4gICAgICAgIHZhbHVlOiBmdW5jdGlvbiBpbml0KG9wdGlvbnMpIHtcbiAgICAgICAgICAgIF9nZXQoT2JqZWN0LmdldFByb3RvdHlwZU9mKENvdW50ZXJHb29nbGVBbmFseXRpY3MucHJvdG90eXBlKSwgJ2luaXQnLCB0aGlzKS5jYWxsKHRoaXMsIG9wdGlvbnMpO1xuICAgICAgICB9XG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIEBwYXJhbSBuYW1lXG4gICAgICAgICAqIEByZXR1cm4ge3t9fVxuICAgICAgICAgKi9cblxuICAgIH0sIHtcbiAgICAgICAga2V5OiAncmVzb2x2ZUpzT2JqZWN0JyxcbiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIHJlc29sdmVKc09iamVjdChuYW1lKSB7XG4gICAgICAgICAgICByZXR1cm4gd2luZG93W25hbWVdIHx8IF9nZXQoT2JqZWN0LmdldFByb3RvdHlwZU9mKENvdW50ZXJHb29nbGVBbmFseXRpY3MucHJvdG90eXBlKSwgJ3Jlc29sdmVKc09iamVjdCcsIHRoaXMpLmNhbGwodGhpcywgbmFtZSk7XG4gICAgICAgIH1cblxuICAgICAgICAvKipcbiAgICAgICAgICogQHBhcmFtIGV2ZW50XG4gICAgICAgICAqIEBwYXJhbSBkYXRhXG4gICAgICAgICAqIEBwYXJhbSBwYXJhbXNcbiAgICAgICAgICovXG5cbiAgICB9LCB7XG4gICAgICAgIGtleTogJ3NlbmRFdmVudCcsXG4gICAgICAgIHZhbHVlOiBmdW5jdGlvbiBzZW5kRXZlbnQoZXZlbnQsIGRhdGEsIHBhcmFtcykge1xuICAgICAgICAgICAgLy8gdGhpcy5qc09iamVjdCgnc2VuZCcsICdldmVudCcsICk7XG4gICAgICAgIH1cbiAgICB9XSk7XG5cbiAgICByZXR1cm4gQ291bnRlckdvb2dsZUFuYWx5dGljcztcbn0oX0NvdW50ZXJJbnRlcmZhY2UyLkNvdW50ZXJJbnRlcmZhY2UpO1xuXG5leHBvcnRzLkNvdW50ZXJHb29nbGVBbmFseXRpY3MgPSBDb3VudGVyR29vZ2xlQW5hbHl0aWNzO1xuXG59LHtcIi4vQ291bnRlckludGVyZmFjZVwiOjR9XSw0OltmdW5jdGlvbihyZXF1aXJlLG1vZHVsZSxleHBvcnRzKXtcblwidXNlIHN0cmljdFwiO1xuXG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHtcbiAgdmFsdWU6IHRydWVcbn0pO1xuXG52YXIgX2NyZWF0ZUNsYXNzID0gZnVuY3Rpb24gKCkgeyBmdW5jdGlvbiBkZWZpbmVQcm9wZXJ0aWVzKHRhcmdldCwgcHJvcHMpIHsgZm9yICh2YXIgaSA9IDA7IGkgPCBwcm9wcy5sZW5ndGg7IGkrKykgeyB2YXIgZGVzY3JpcHRvciA9IHByb3BzW2ldOyBkZXNjcmlwdG9yLmVudW1lcmFibGUgPSBkZXNjcmlwdG9yLmVudW1lcmFibGUgfHwgZmFsc2U7IGRlc2NyaXB0b3IuY29uZmlndXJhYmxlID0gdHJ1ZTsgaWYgKFwidmFsdWVcIiBpbiBkZXNjcmlwdG9yKSBkZXNjcmlwdG9yLndyaXRhYmxlID0gdHJ1ZTsgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRhcmdldCwgZGVzY3JpcHRvci5rZXksIGRlc2NyaXB0b3IpOyB9IH0gcmV0dXJuIGZ1bmN0aW9uIChDb25zdHJ1Y3RvciwgcHJvdG9Qcm9wcywgc3RhdGljUHJvcHMpIHsgaWYgKHByb3RvUHJvcHMpIGRlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IucHJvdG90eXBlLCBwcm90b1Byb3BzKTsgaWYgKHN0YXRpY1Byb3BzKSBkZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLCBzdGF0aWNQcm9wcyk7IHJldHVybiBDb25zdHJ1Y3RvcjsgfTsgfSgpO1xuXG5mdW5jdGlvbiBfY2xhc3NDYWxsQ2hlY2soaW5zdGFuY2UsIENvbnN0cnVjdG9yKSB7IGlmICghKGluc3RhbmNlIGluc3RhbmNlb2YgQ29uc3RydWN0b3IpKSB7IHRocm93IG5ldyBUeXBlRXJyb3IoXCJDYW5ub3QgY2FsbCBhIGNsYXNzIGFzIGEgZnVuY3Rpb25cIik7IH0gfVxuXG52YXIgQ291bnRlckludGVyZmFjZSA9IGZ1bmN0aW9uICgpIHtcbiAgLyoqXG4gICAqIEBwYXJhbSBsb2NhdG9yXG4gICAqIEBwYXJhbSBqc09iamVjdFxuICAgKiBAcGFyYW0gb3B0aW9uc1xuICAgKi9cblxuICBmdW5jdGlvbiBDb3VudGVySW50ZXJmYWNlKGxvY2F0b3IsIGpzT2JqZWN0LCBvcHRpb25zKSB7XG4gICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIENvdW50ZXJJbnRlcmZhY2UpO1xuXG4gICAgdGhpcy5sb2NhdG9yID0gbG9jYXRvcjtcbiAgICB0aGlzLmpzT2JqZWN0ID0gdGhpcy5yZXNvbHZlSnNPYmplY3QoanNPYmplY3QpO1xuICAgIHRoaXMucmF3T3B0aW9ucyA9IG9wdGlvbnM7XG4gICAgdGhpcy5pbml0KG9wdGlvbnMpO1xuICB9XG5cbiAgLyoqXG4gICAqIEluaXRcbiAgICogQHBhcmFtIG9wdGlvbnNcbiAgICovXG5cblxuICBfY3JlYXRlQ2xhc3MoQ291bnRlckludGVyZmFjZSwgW3tcbiAgICBrZXk6IFwiaW5pdFwiLFxuICAgIHZhbHVlOiBmdW5jdGlvbiBpbml0KG9wdGlvbnMpIHt9XG5cbiAgICAvKipcbiAgICAgKiBAcGFyYW0gbmFtZVxuICAgICAqIEByZXR1cm4ge3t9fVxuICAgICAqL1xuXG4gIH0sIHtcbiAgICBrZXk6IFwicmVzb2x2ZUpzT2JqZWN0XCIsXG4gICAgdmFsdWU6IGZ1bmN0aW9uIHJlc29sdmVKc09iamVjdChuYW1lKSB7XG4gICAgICByZXR1cm4ge307XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogU2VuZCBldmVudFxuICAgICAqIEBwYXJhbSBldmVudFxuICAgICAqIEBwYXJhbSBkYXRhXG4gICAgICogQHBhcmFtIHBhcmFtc1xuICAgICAqL1xuXG4gIH0sIHtcbiAgICBrZXk6IFwic2VuZEV2ZW50XCIsXG4gICAgdmFsdWU6IGZ1bmN0aW9uIHNlbmRFdmVudChldmVudCwgZGF0YSwgcGFyYW1zKSB7fVxuICB9XSk7XG5cbiAgcmV0dXJuIENvdW50ZXJJbnRlcmZhY2U7XG59KCk7XG5cbmV4cG9ydHMuQ291bnRlckludGVyZmFjZSA9IENvdW50ZXJJbnRlcmZhY2U7XG5cbn0se31dLDU6W2Z1bmN0aW9uKHJlcXVpcmUsbW9kdWxlLGV4cG9ydHMpe1xuJ3VzZSBzdHJpY3QnO1xuXG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHtcbiAgdmFsdWU6IHRydWVcbn0pO1xuZXhwb3J0cy5Db3VudGVyUGl3aWsgPSB1bmRlZmluZWQ7XG5cbnZhciBfY3JlYXRlQ2xhc3MgPSBmdW5jdGlvbiAoKSB7IGZ1bmN0aW9uIGRlZmluZVByb3BlcnRpZXModGFyZ2V0LCBwcm9wcykgeyBmb3IgKHZhciBpID0gMDsgaSA8IHByb3BzLmxlbmd0aDsgaSsrKSB7IHZhciBkZXNjcmlwdG9yID0gcHJvcHNbaV07IGRlc2NyaXB0b3IuZW51bWVyYWJsZSA9IGRlc2NyaXB0b3IuZW51bWVyYWJsZSB8fCBmYWxzZTsgZGVzY3JpcHRvci5jb25maWd1cmFibGUgPSB0cnVlOyBpZiAoXCJ2YWx1ZVwiIGluIGRlc2NyaXB0b3IpIGRlc2NyaXB0b3Iud3JpdGFibGUgPSB0cnVlOyBPYmplY3QuZGVmaW5lUHJvcGVydHkodGFyZ2V0LCBkZXNjcmlwdG9yLmtleSwgZGVzY3JpcHRvcik7IH0gfSByZXR1cm4gZnVuY3Rpb24gKENvbnN0cnVjdG9yLCBwcm90b1Byb3BzLCBzdGF0aWNQcm9wcykgeyBpZiAocHJvdG9Qcm9wcykgZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvci5wcm90b3R5cGUsIHByb3RvUHJvcHMpOyBpZiAoc3RhdGljUHJvcHMpIGRlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IsIHN0YXRpY1Byb3BzKTsgcmV0dXJuIENvbnN0cnVjdG9yOyB9OyB9KCk7XG5cbnZhciBfZ2V0ID0gZnVuY3Rpb24gZ2V0KG9iamVjdCwgcHJvcGVydHksIHJlY2VpdmVyKSB7IGlmIChvYmplY3QgPT09IG51bGwpIG9iamVjdCA9IEZ1bmN0aW9uLnByb3RvdHlwZTsgdmFyIGRlc2MgPSBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKG9iamVjdCwgcHJvcGVydHkpOyBpZiAoZGVzYyA9PT0gdW5kZWZpbmVkKSB7IHZhciBwYXJlbnQgPSBPYmplY3QuZ2V0UHJvdG90eXBlT2Yob2JqZWN0KTsgaWYgKHBhcmVudCA9PT0gbnVsbCkgeyByZXR1cm4gdW5kZWZpbmVkOyB9IGVsc2UgeyByZXR1cm4gZ2V0KHBhcmVudCwgcHJvcGVydHksIHJlY2VpdmVyKTsgfSB9IGVsc2UgaWYgKFwidmFsdWVcIiBpbiBkZXNjKSB7IHJldHVybiBkZXNjLnZhbHVlOyB9IGVsc2UgeyB2YXIgZ2V0dGVyID0gZGVzYy5nZXQ7IGlmIChnZXR0ZXIgPT09IHVuZGVmaW5lZCkgeyByZXR1cm4gdW5kZWZpbmVkOyB9IHJldHVybiBnZXR0ZXIuY2FsbChyZWNlaXZlcik7IH0gfTtcblxudmFyIF9Db3VudGVySW50ZXJmYWNlMiA9IHJlcXVpcmUoJy4vQ291bnRlckludGVyZmFjZScpO1xuXG5mdW5jdGlvbiBfY2xhc3NDYWxsQ2hlY2soaW5zdGFuY2UsIENvbnN0cnVjdG9yKSB7IGlmICghKGluc3RhbmNlIGluc3RhbmNlb2YgQ29uc3RydWN0b3IpKSB7IHRocm93IG5ldyBUeXBlRXJyb3IoXCJDYW5ub3QgY2FsbCBhIGNsYXNzIGFzIGEgZnVuY3Rpb25cIik7IH0gfVxuXG5mdW5jdGlvbiBfcG9zc2libGVDb25zdHJ1Y3RvclJldHVybihzZWxmLCBjYWxsKSB7IGlmICghc2VsZikgeyB0aHJvdyBuZXcgUmVmZXJlbmNlRXJyb3IoXCJ0aGlzIGhhc24ndCBiZWVuIGluaXRpYWxpc2VkIC0gc3VwZXIoKSBoYXNuJ3QgYmVlbiBjYWxsZWRcIik7IH0gcmV0dXJuIGNhbGwgJiYgKHR5cGVvZiBjYWxsID09PSBcIm9iamVjdFwiIHx8IHR5cGVvZiBjYWxsID09PSBcImZ1bmN0aW9uXCIpID8gY2FsbCA6IHNlbGY7IH1cblxuZnVuY3Rpb24gX2luaGVyaXRzKHN1YkNsYXNzLCBzdXBlckNsYXNzKSB7IGlmICh0eXBlb2Ygc3VwZXJDbGFzcyAhPT0gXCJmdW5jdGlvblwiICYmIHN1cGVyQ2xhc3MgIT09IG51bGwpIHsgdGhyb3cgbmV3IFR5cGVFcnJvcihcIlN1cGVyIGV4cHJlc3Npb24gbXVzdCBlaXRoZXIgYmUgbnVsbCBvciBhIGZ1bmN0aW9uLCBub3QgXCIgKyB0eXBlb2Ygc3VwZXJDbGFzcyk7IH0gc3ViQ2xhc3MucHJvdG90eXBlID0gT2JqZWN0LmNyZWF0ZShzdXBlckNsYXNzICYmIHN1cGVyQ2xhc3MucHJvdG90eXBlLCB7IGNvbnN0cnVjdG9yOiB7IHZhbHVlOiBzdWJDbGFzcywgZW51bWVyYWJsZTogZmFsc2UsIHdyaXRhYmxlOiB0cnVlLCBjb25maWd1cmFibGU6IHRydWUgfSB9KTsgaWYgKHN1cGVyQ2xhc3MpIE9iamVjdC5zZXRQcm90b3R5cGVPZiA/IE9iamVjdC5zZXRQcm90b3R5cGVPZihzdWJDbGFzcywgc3VwZXJDbGFzcykgOiBzdWJDbGFzcy5fX3Byb3RvX18gPSBzdXBlckNsYXNzOyB9XG5cbnZhciBDb3VudGVyUGl3aWsgPSBmdW5jdGlvbiAoX0NvdW50ZXJJbnRlcmZhY2UpIHtcbiAgX2luaGVyaXRzKENvdW50ZXJQaXdpaywgX0NvdW50ZXJJbnRlcmZhY2UpO1xuXG4gIGZ1bmN0aW9uIENvdW50ZXJQaXdpaygpIHtcbiAgICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgQ291bnRlclBpd2lrKTtcblxuICAgIHJldHVybiBfcG9zc2libGVDb25zdHJ1Y3RvclJldHVybih0aGlzLCBPYmplY3QuZ2V0UHJvdG90eXBlT2YoQ291bnRlclBpd2lrKS5hcHBseSh0aGlzLCBhcmd1bWVudHMpKTtcbiAgfVxuXG4gIF9jcmVhdGVDbGFzcyhDb3VudGVyUGl3aWssIFt7XG4gICAga2V5OiAnaW5pdCcsXG5cbiAgICAvKipcbiAgICAgKiBAcGFyYW0gb3B0aW9uc1xuICAgICAqL1xuICAgIHZhbHVlOiBmdW5jdGlvbiBpbml0KG9wdGlvbnMpIHtcbiAgICAgIF9nZXQoT2JqZWN0LmdldFByb3RvdHlwZU9mKENvdW50ZXJQaXdpay5wcm90b3R5cGUpLCAnaW5pdCcsIHRoaXMpLmNhbGwodGhpcywgb3B0aW9ucyk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQHBhcmFtIG5hbWVcbiAgICAgKiBAcmV0dXJuIHt7fX1cbiAgICAgKi9cblxuICB9LCB7XG4gICAga2V5OiAncmVzb2x2ZUpzT2JqZWN0JyxcbiAgICB2YWx1ZTogZnVuY3Rpb24gcmVzb2x2ZUpzT2JqZWN0KG5hbWUpIHtcbiAgICAgIHJldHVybiB3aW5kb3dbbmFtZV0gfHwgX2dldChPYmplY3QuZ2V0UHJvdG90eXBlT2YoQ291bnRlclBpd2lrLnByb3RvdHlwZSksICdyZXNvbHZlSnNPYmplY3QnLCB0aGlzKS5jYWxsKHRoaXMsIG5hbWUpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEBwYXJhbSBldmVudFxuICAgICAqIEBwYXJhbSBkYXRhXG4gICAgICogQHBhcmFtIHBhcmFtc1xuICAgICAqL1xuXG4gIH0sIHtcbiAgICBrZXk6ICdzZW5kRXZlbnQnLFxuICAgIHZhbHVlOiBmdW5jdGlvbiBzZW5kRXZlbnQoZXZlbnQsIGRhdGEsIHBhcmFtcykge31cbiAgfV0pO1xuXG4gIHJldHVybiBDb3VudGVyUGl3aWs7XG59KF9Db3VudGVySW50ZXJmYWNlMi5Db3VudGVySW50ZXJmYWNlKTtcblxuZXhwb3J0cy5Db3VudGVyUGl3aWsgPSBDb3VudGVyUGl3aWs7XG5cbn0se1wiLi9Db3VudGVySW50ZXJmYWNlXCI6NH1dLDY6W2Z1bmN0aW9uKHJlcXVpcmUsbW9kdWxlLGV4cG9ydHMpe1xuJ3VzZSBzdHJpY3QnO1xuXG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHtcbiAgICB2YWx1ZTogdHJ1ZVxufSk7XG5leHBvcnRzLkNvdW50ZXJZYW5kZXhNZXRyaWthID0gdW5kZWZpbmVkO1xuXG52YXIgX2NyZWF0ZUNsYXNzID0gZnVuY3Rpb24gKCkgeyBmdW5jdGlvbiBkZWZpbmVQcm9wZXJ0aWVzKHRhcmdldCwgcHJvcHMpIHsgZm9yICh2YXIgaSA9IDA7IGkgPCBwcm9wcy5sZW5ndGg7IGkrKykgeyB2YXIgZGVzY3JpcHRvciA9IHByb3BzW2ldOyBkZXNjcmlwdG9yLmVudW1lcmFibGUgPSBkZXNjcmlwdG9yLmVudW1lcmFibGUgfHwgZmFsc2U7IGRlc2NyaXB0b3IuY29uZmlndXJhYmxlID0gdHJ1ZTsgaWYgKFwidmFsdWVcIiBpbiBkZXNjcmlwdG9yKSBkZXNjcmlwdG9yLndyaXRhYmxlID0gdHJ1ZTsgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRhcmdldCwgZGVzY3JpcHRvci5rZXksIGRlc2NyaXB0b3IpOyB9IH0gcmV0dXJuIGZ1bmN0aW9uIChDb25zdHJ1Y3RvciwgcHJvdG9Qcm9wcywgc3RhdGljUHJvcHMpIHsgaWYgKHByb3RvUHJvcHMpIGRlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IucHJvdG90eXBlLCBwcm90b1Byb3BzKTsgaWYgKHN0YXRpY1Byb3BzKSBkZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLCBzdGF0aWNQcm9wcyk7IHJldHVybiBDb25zdHJ1Y3RvcjsgfTsgfSgpO1xuXG52YXIgX2dldCA9IGZ1bmN0aW9uIGdldChvYmplY3QsIHByb3BlcnR5LCByZWNlaXZlcikgeyBpZiAob2JqZWN0ID09PSBudWxsKSBvYmplY3QgPSBGdW5jdGlvbi5wcm90b3R5cGU7IHZhciBkZXNjID0gT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcihvYmplY3QsIHByb3BlcnR5KTsgaWYgKGRlc2MgPT09IHVuZGVmaW5lZCkgeyB2YXIgcGFyZW50ID0gT2JqZWN0LmdldFByb3RvdHlwZU9mKG9iamVjdCk7IGlmIChwYXJlbnQgPT09IG51bGwpIHsgcmV0dXJuIHVuZGVmaW5lZDsgfSBlbHNlIHsgcmV0dXJuIGdldChwYXJlbnQsIHByb3BlcnR5LCByZWNlaXZlcik7IH0gfSBlbHNlIGlmIChcInZhbHVlXCIgaW4gZGVzYykgeyByZXR1cm4gZGVzYy52YWx1ZTsgfSBlbHNlIHsgdmFyIGdldHRlciA9IGRlc2MuZ2V0OyBpZiAoZ2V0dGVyID09PSB1bmRlZmluZWQpIHsgcmV0dXJuIHVuZGVmaW5lZDsgfSByZXR1cm4gZ2V0dGVyLmNhbGwocmVjZWl2ZXIpOyB9IH07XG5cbnZhciBfQ291bnRlckludGVyZmFjZTIgPSByZXF1aXJlKCcuL0NvdW50ZXJJbnRlcmZhY2UnKTtcblxuZnVuY3Rpb24gX2NsYXNzQ2FsbENoZWNrKGluc3RhbmNlLCBDb25zdHJ1Y3RvcikgeyBpZiAoIShpbnN0YW5jZSBpbnN0YW5jZW9mIENvbnN0cnVjdG9yKSkgeyB0aHJvdyBuZXcgVHlwZUVycm9yKFwiQ2Fubm90IGNhbGwgYSBjbGFzcyBhcyBhIGZ1bmN0aW9uXCIpOyB9IH1cblxuZnVuY3Rpb24gX3Bvc3NpYmxlQ29uc3RydWN0b3JSZXR1cm4oc2VsZiwgY2FsbCkgeyBpZiAoIXNlbGYpIHsgdGhyb3cgbmV3IFJlZmVyZW5jZUVycm9yKFwidGhpcyBoYXNuJ3QgYmVlbiBpbml0aWFsaXNlZCAtIHN1cGVyKCkgaGFzbid0IGJlZW4gY2FsbGVkXCIpOyB9IHJldHVybiBjYWxsICYmICh0eXBlb2YgY2FsbCA9PT0gXCJvYmplY3RcIiB8fCB0eXBlb2YgY2FsbCA9PT0gXCJmdW5jdGlvblwiKSA/IGNhbGwgOiBzZWxmOyB9XG5cbmZ1bmN0aW9uIF9pbmhlcml0cyhzdWJDbGFzcywgc3VwZXJDbGFzcykgeyBpZiAodHlwZW9mIHN1cGVyQ2xhc3MgIT09IFwiZnVuY3Rpb25cIiAmJiBzdXBlckNsYXNzICE9PSBudWxsKSB7IHRocm93IG5ldyBUeXBlRXJyb3IoXCJTdXBlciBleHByZXNzaW9uIG11c3QgZWl0aGVyIGJlIG51bGwgb3IgYSBmdW5jdGlvbiwgbm90IFwiICsgdHlwZW9mIHN1cGVyQ2xhc3MpOyB9IHN1YkNsYXNzLnByb3RvdHlwZSA9IE9iamVjdC5jcmVhdGUoc3VwZXJDbGFzcyAmJiBzdXBlckNsYXNzLnByb3RvdHlwZSwgeyBjb25zdHJ1Y3RvcjogeyB2YWx1ZTogc3ViQ2xhc3MsIGVudW1lcmFibGU6IGZhbHNlLCB3cml0YWJsZTogdHJ1ZSwgY29uZmlndXJhYmxlOiB0cnVlIH0gfSk7IGlmIChzdXBlckNsYXNzKSBPYmplY3Quc2V0UHJvdG90eXBlT2YgPyBPYmplY3Quc2V0UHJvdG90eXBlT2Yoc3ViQ2xhc3MsIHN1cGVyQ2xhc3MpIDogc3ViQ2xhc3MuX19wcm90b19fID0gc3VwZXJDbGFzczsgfVxuXG52YXIgQ291bnRlcllhbmRleE1ldHJpa2EgPSBmdW5jdGlvbiAoX0NvdW50ZXJJbnRlcmZhY2UpIHtcbiAgICBfaW5oZXJpdHMoQ291bnRlcllhbmRleE1ldHJpa2EsIF9Db3VudGVySW50ZXJmYWNlKTtcblxuICAgIGZ1bmN0aW9uIENvdW50ZXJZYW5kZXhNZXRyaWthKCkge1xuICAgICAgICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgQ291bnRlcllhbmRleE1ldHJpa2EpO1xuXG4gICAgICAgIHJldHVybiBfcG9zc2libGVDb25zdHJ1Y3RvclJldHVybih0aGlzLCBPYmplY3QuZ2V0UHJvdG90eXBlT2YoQ291bnRlcllhbmRleE1ldHJpa2EpLmFwcGx5KHRoaXMsIGFyZ3VtZW50cykpO1xuICAgIH1cblxuICAgIF9jcmVhdGVDbGFzcyhDb3VudGVyWWFuZGV4TWV0cmlrYSwgW3tcbiAgICAgICAga2V5OiAnaW5pdCcsXG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIEBwYXJhbSBvcHRpb25zXG4gICAgICAgICAqL1xuICAgICAgICB2YWx1ZTogZnVuY3Rpb24gaW5pdChvcHRpb25zKSB7XG4gICAgICAgICAgICBfZ2V0KE9iamVjdC5nZXRQcm90b3R5cGVPZihDb3VudGVyWWFuZGV4TWV0cmlrYS5wcm90b3R5cGUpLCAnaW5pdCcsIHRoaXMpLmNhbGwodGhpcywgb3B0aW9ucyk7XG4gICAgICAgIH1cblxuICAgICAgICAvKipcbiAgICAgICAgICogQHBhcmFtIG5hbWVcbiAgICAgICAgICogQHJldHVybiB7e319XG4gICAgICAgICAqL1xuXG4gICAgfSwge1xuICAgICAgICBrZXk6ICdyZXNvbHZlSnNPYmplY3QnLFxuICAgICAgICB2YWx1ZTogZnVuY3Rpb24gcmVzb2x2ZUpzT2JqZWN0KG5hbWUpIHtcbiAgICAgICAgICAgIHJldHVybiB3aW5kb3dbJ3lhQ291bnRlcicgKyBuYW1lXSB8fCBfZ2V0KE9iamVjdC5nZXRQcm90b3R5cGVPZihDb3VudGVyWWFuZGV4TWV0cmlrYS5wcm90b3R5cGUpLCAncmVzb2x2ZUpzT2JqZWN0JywgdGhpcykuY2FsbCh0aGlzLCBuYW1lKTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBAcGFyYW0gZXZlbnRcbiAgICAgICAgICogQHBhcmFtIGRhdGFcbiAgICAgICAgICogQHBhcmFtIHBhcmFtc1xuICAgICAgICAgKi9cblxuICAgIH0sIHtcbiAgICAgICAga2V5OiAnc2VuZEV2ZW50JyxcbiAgICAgICAgdmFsdWU6IGZ1bmN0aW9uIHNlbmRFdmVudChldmVudCwgZGF0YSwgcGFyYW1zKSB7XG4gICAgICAgICAgICBjb25zb2xlLmxvZyhldmVudCk7XG4gICAgICAgICAgICAvL3RoaXMuanNPYmplY3QucmVhY2hHb2FsKGV2ZW50LCBwYXJhbXMgfHwge30pO1xuICAgICAgICB9XG4gICAgfV0pO1xuXG4gICAgcmV0dXJuIENvdW50ZXJZYW5kZXhNZXRyaWthO1xufShfQ291bnRlckludGVyZmFjZTIuQ291bnRlckludGVyZmFjZSk7XG5cbmV4cG9ydHMuQ291bnRlcllhbmRleE1ldHJpa2EgPSBDb3VudGVyWWFuZGV4TWV0cmlrYTtcblxufSx7XCIuL0NvdW50ZXJJbnRlcmZhY2VcIjo0fV0sNzpbZnVuY3Rpb24ocmVxdWlyZSxtb2R1bGUsZXhwb3J0cyl7XG4ndXNlIHN0cmljdCc7XG5cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwge1xuICAgIHZhbHVlOiB0cnVlXG59KTtcbmV4cG9ydHMuQ2xpY2sgPSB1bmRlZmluZWQ7XG5cbnZhciBfY3JlYXRlQ2xhc3MgPSBmdW5jdGlvbiAoKSB7IGZ1bmN0aW9uIGRlZmluZVByb3BlcnRpZXModGFyZ2V0LCBwcm9wcykgeyBmb3IgKHZhciBpID0gMDsgaSA8IHByb3BzLmxlbmd0aDsgaSsrKSB7IHZhciBkZXNjcmlwdG9yID0gcHJvcHNbaV07IGRlc2NyaXB0b3IuZW51bWVyYWJsZSA9IGRlc2NyaXB0b3IuZW51bWVyYWJsZSB8fCBmYWxzZTsgZGVzY3JpcHRvci5jb25maWd1cmFibGUgPSB0cnVlOyBpZiAoXCJ2YWx1ZVwiIGluIGRlc2NyaXB0b3IpIGRlc2NyaXB0b3Iud3JpdGFibGUgPSB0cnVlOyBPYmplY3QuZGVmaW5lUHJvcGVydHkodGFyZ2V0LCBkZXNjcmlwdG9yLmtleSwgZGVzY3JpcHRvcik7IH0gfSByZXR1cm4gZnVuY3Rpb24gKENvbnN0cnVjdG9yLCBwcm90b1Byb3BzLCBzdGF0aWNQcm9wcykgeyBpZiAocHJvdG9Qcm9wcykgZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvci5wcm90b3R5cGUsIHByb3RvUHJvcHMpOyBpZiAoc3RhdGljUHJvcHMpIGRlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IsIHN0YXRpY1Byb3BzKTsgcmV0dXJuIENvbnN0cnVjdG9yOyB9OyB9KCk7XG5cbnZhciBfRXZlbnRJbnRlcmZhY2UyID0gcmVxdWlyZSgnLi9FdmVudEludGVyZmFjZScpO1xuXG5mdW5jdGlvbiBfY2xhc3NDYWxsQ2hlY2soaW5zdGFuY2UsIENvbnN0cnVjdG9yKSB7IGlmICghKGluc3RhbmNlIGluc3RhbmNlb2YgQ29uc3RydWN0b3IpKSB7IHRocm93IG5ldyBUeXBlRXJyb3IoXCJDYW5ub3QgY2FsbCBhIGNsYXNzIGFzIGEgZnVuY3Rpb25cIik7IH0gfVxuXG5mdW5jdGlvbiBfcG9zc2libGVDb25zdHJ1Y3RvclJldHVybihzZWxmLCBjYWxsKSB7IGlmICghc2VsZikgeyB0aHJvdyBuZXcgUmVmZXJlbmNlRXJyb3IoXCJ0aGlzIGhhc24ndCBiZWVuIGluaXRpYWxpc2VkIC0gc3VwZXIoKSBoYXNuJ3QgYmVlbiBjYWxsZWRcIik7IH0gcmV0dXJuIGNhbGwgJiYgKHR5cGVvZiBjYWxsID09PSBcIm9iamVjdFwiIHx8IHR5cGVvZiBjYWxsID09PSBcImZ1bmN0aW9uXCIpID8gY2FsbCA6IHNlbGY7IH1cblxuZnVuY3Rpb24gX2luaGVyaXRzKHN1YkNsYXNzLCBzdXBlckNsYXNzKSB7IGlmICh0eXBlb2Ygc3VwZXJDbGFzcyAhPT0gXCJmdW5jdGlvblwiICYmIHN1cGVyQ2xhc3MgIT09IG51bGwpIHsgdGhyb3cgbmV3IFR5cGVFcnJvcihcIlN1cGVyIGV4cHJlc3Npb24gbXVzdCBlaXRoZXIgYmUgbnVsbCBvciBhIGZ1bmN0aW9uLCBub3QgXCIgKyB0eXBlb2Ygc3VwZXJDbGFzcyk7IH0gc3ViQ2xhc3MucHJvdG90eXBlID0gT2JqZWN0LmNyZWF0ZShzdXBlckNsYXNzICYmIHN1cGVyQ2xhc3MucHJvdG90eXBlLCB7IGNvbnN0cnVjdG9yOiB7IHZhbHVlOiBzdWJDbGFzcywgZW51bWVyYWJsZTogZmFsc2UsIHdyaXRhYmxlOiB0cnVlLCBjb25maWd1cmFibGU6IHRydWUgfSB9KTsgaWYgKHN1cGVyQ2xhc3MpIE9iamVjdC5zZXRQcm90b3R5cGVPZiA/IE9iamVjdC5zZXRQcm90b3R5cGVPZihzdWJDbGFzcywgc3VwZXJDbGFzcykgOiBzdWJDbGFzcy5fX3Byb3RvX18gPSBzdXBlckNsYXNzOyB9XG5cbnZhciBDbGljayA9IGZ1bmN0aW9uIChfRXZlbnRJbnRlcmZhY2UpIHtcbiAgICBfaW5oZXJpdHMoQ2xpY2ssIF9FdmVudEludGVyZmFjZSk7XG5cbiAgICBmdW5jdGlvbiBDbGljaygpIHtcbiAgICAgICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIENsaWNrKTtcblxuICAgICAgICByZXR1cm4gX3Bvc3NpYmxlQ29uc3RydWN0b3JSZXR1cm4odGhpcywgT2JqZWN0LmdldFByb3RvdHlwZU9mKENsaWNrKS5hcHBseSh0aGlzLCBhcmd1bWVudHMpKTtcbiAgICB9XG5cbiAgICBfY3JlYXRlQ2xhc3MoQ2xpY2ssIFt7XG4gICAgICAgIGtleTogJ2hhbmRsZScsXG5cblxuICAgICAgICAvKipcbiAgICAgICAgICogSGFuZGxlclxuICAgICAgICAgKiBAcGFyYW0gZXZlbnRcbiAgICAgICAgICovXG4gICAgICAgIHZhbHVlOiBmdW5jdGlvbiBoYW5kbGUoZXZlbnQpIHtcbiAgICAgICAgICAgIHZhciBfaXRlcmF0b3JOb3JtYWxDb21wbGV0aW9uID0gdHJ1ZTtcbiAgICAgICAgICAgIHZhciBfZGlkSXRlcmF0b3JFcnJvciA9IGZhbHNlO1xuICAgICAgICAgICAgdmFyIF9pdGVyYXRvckVycm9yID0gdW5kZWZpbmVkO1xuXG4gICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgIGZvciAodmFyIF9pdGVyYXRvciA9IHRoaXMubG9jYXRvci5jb3VudGVycy52YWx1ZXMoKVtTeW1ib2wuaXRlcmF0b3JdKCksIF9zdGVwOyAhKF9pdGVyYXRvck5vcm1hbENvbXBsZXRpb24gPSAoX3N0ZXAgPSBfaXRlcmF0b3IubmV4dCgpKS5kb25lKTsgX2l0ZXJhdG9yTm9ybWFsQ29tcGxldGlvbiA9IHRydWUpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIGNvdW50ZXIgPSBfc3RlcC52YWx1ZTtcblxuICAgICAgICAgICAgICAgICAgICBjb3VudGVyLnNlbmRFdmVudChldmVudCwge30sIHt9KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9IGNhdGNoIChlcnIpIHtcbiAgICAgICAgICAgICAgICBfZGlkSXRlcmF0b3JFcnJvciA9IHRydWU7XG4gICAgICAgICAgICAgICAgX2l0ZXJhdG9yRXJyb3IgPSBlcnI7XG4gICAgICAgICAgICB9IGZpbmFsbHkge1xuICAgICAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgICAgIGlmICghX2l0ZXJhdG9yTm9ybWFsQ29tcGxldGlvbiAmJiBfaXRlcmF0b3IucmV0dXJuKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBfaXRlcmF0b3IucmV0dXJuKCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9IGZpbmFsbHkge1xuICAgICAgICAgICAgICAgICAgICBpZiAoX2RpZEl0ZXJhdG9yRXJyb3IpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRocm93IF9pdGVyYXRvckVycm9yO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfSwge1xuICAgICAgICBrZXk6ICdldmVudE5hbWUnLFxuICAgICAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHtcbiAgICAgICAgICAgIHJldHVybiAnY2xpY2snO1xuICAgICAgICB9XG4gICAgfV0pO1xuXG4gICAgcmV0dXJuIENsaWNrO1xufShfRXZlbnRJbnRlcmZhY2UyLkV2ZW50SW50ZXJmYWNlKTtcblxuZXhwb3J0cy5DbGljayA9IENsaWNrO1xuXG59LHtcIi4vRXZlbnRJbnRlcmZhY2VcIjo4fV0sODpbZnVuY3Rpb24ocmVxdWlyZSxtb2R1bGUsZXhwb3J0cyl7XG4ndXNlIHN0cmljdCc7XG5cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwge1xuICAgIHZhbHVlOiB0cnVlXG59KTtcblxudmFyIF9jcmVhdGVDbGFzcyA9IGZ1bmN0aW9uICgpIHsgZnVuY3Rpb24gZGVmaW5lUHJvcGVydGllcyh0YXJnZXQsIHByb3BzKSB7IGZvciAodmFyIGkgPSAwOyBpIDwgcHJvcHMubGVuZ3RoOyBpKyspIHsgdmFyIGRlc2NyaXB0b3IgPSBwcm9wc1tpXTsgZGVzY3JpcHRvci5lbnVtZXJhYmxlID0gZGVzY3JpcHRvci5lbnVtZXJhYmxlIHx8IGZhbHNlOyBkZXNjcmlwdG9yLmNvbmZpZ3VyYWJsZSA9IHRydWU7IGlmIChcInZhbHVlXCIgaW4gZGVzY3JpcHRvcikgZGVzY3JpcHRvci53cml0YWJsZSA9IHRydWU7IE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIGRlc2NyaXB0b3Iua2V5LCBkZXNjcmlwdG9yKTsgfSB9IHJldHVybiBmdW5jdGlvbiAoQ29uc3RydWN0b3IsIHByb3RvUHJvcHMsIHN0YXRpY1Byb3BzKSB7IGlmIChwcm90b1Byb3BzKSBkZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLnByb3RvdHlwZSwgcHJvdG9Qcm9wcyk7IGlmIChzdGF0aWNQcm9wcykgZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvciwgc3RhdGljUHJvcHMpOyByZXR1cm4gQ29uc3RydWN0b3I7IH07IH0oKTtcblxuZnVuY3Rpb24gX2NsYXNzQ2FsbENoZWNrKGluc3RhbmNlLCBDb25zdHJ1Y3RvcikgeyBpZiAoIShpbnN0YW5jZSBpbnN0YW5jZW9mIENvbnN0cnVjdG9yKSkgeyB0aHJvdyBuZXcgVHlwZUVycm9yKFwiQ2Fubm90IGNhbGwgYSBjbGFzcyBhcyBhIGZ1bmN0aW9uXCIpOyB9IH1cblxudmFyIEV2ZW50SW50ZXJmYWNlID0gZnVuY3Rpb24gKCkge1xuXG4gICAgLyoqXG4gICAgICogQHBhcmFtIGxvY2F0b3IgVW5pb25BbmFseXRpY3NcbiAgICAgKiBAcGFyYW0gb3B0aW9uc1xuICAgICAqL1xuXG4gICAgZnVuY3Rpb24gRXZlbnRJbnRlcmZhY2UobG9jYXRvciwgb3B0aW9ucykge1xuICAgICAgICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgRXZlbnRJbnRlcmZhY2UpO1xuXG4gICAgICAgIHRoaXMubG9jYXRvciA9IGxvY2F0b3I7XG4gICAgICAgIHRoaXMuaW5pdChvcHRpb25zKTtcbiAgICAgICAgdGhpcy5hdHRhY2hIYW5kbGVycyhvcHRpb25zKTtcbiAgICB9XG5cbiAgICBfY3JlYXRlQ2xhc3MoRXZlbnRJbnRlcmZhY2UsIFt7XG4gICAgICAgIGtleTogJ2luaXQnLFxuXG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIEluaXRcbiAgICAgICAgICogQHBhcmFtIG9wdGlvbnNcbiAgICAgICAgICovXG4gICAgICAgIHZhbHVlOiBmdW5jdGlvbiBpbml0KG9wdGlvbnMpIHt9XG4gICAgfSwge1xuICAgICAgICBrZXk6ICdhdHRhY2hIYW5kbGVycycsXG4gICAgICAgIHZhbHVlOiBmdW5jdGlvbiBhdHRhY2hIYW5kbGVycyhvcHRpb25zKSB7XG4gICAgICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuXG4gICAgICAgICAgICB2YXIgaGFzID0gT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eTtcbiAgICAgICAgICAgIGlmIChvcHRpb25zICE9PSBudWxsICYmIGhhcy5jYWxsKG9wdGlvbnMsICdzZWxlY3RvcnMnKSkge1xuICAgICAgICAgICAgICAgIHZhciBfaXRlcmF0b3JOb3JtYWxDb21wbGV0aW9uID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICB2YXIgX2RpZEl0ZXJhdG9yRXJyb3IgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICB2YXIgX2l0ZXJhdG9yRXJyb3IgPSB1bmRlZmluZWQ7XG5cbiAgICAgICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBfaXRlcmF0b3IgPSBvcHRpb25zLnNlbGVjdG9yc1tTeW1ib2wuaXRlcmF0b3JdKCksIF9zdGVwOyAhKF9pdGVyYXRvck5vcm1hbENvbXBsZXRpb24gPSAoX3N0ZXAgPSBfaXRlcmF0b3IubmV4dCgpKS5kb25lKTsgX2l0ZXJhdG9yTm9ybWFsQ29tcGxldGlvbiA9IHRydWUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBzZWxlY3RvciA9IF9zdGVwLnZhbHVlO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgZWxlbWVudHMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKHNlbGVjdG9yKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgZWxlbWVudHMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbGVtZW50c1tpXS5hZGRFdmVudExpc3RlbmVyKHRoaXMuZXZlbnROYW1lLCBmdW5jdGlvbiAoZXZlbnQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIF90aGlzLmhhbmRsZShldmVudCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9IGNhdGNoIChlcnIpIHtcbiAgICAgICAgICAgICAgICAgICAgX2RpZEl0ZXJhdG9yRXJyb3IgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICBfaXRlcmF0b3JFcnJvciA9IGVycjtcbiAgICAgICAgICAgICAgICB9IGZpbmFsbHkge1xuICAgICAgICAgICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFfaXRlcmF0b3JOb3JtYWxDb21wbGV0aW9uICYmIF9pdGVyYXRvci5yZXR1cm4pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBfaXRlcmF0b3IucmV0dXJuKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH0gZmluYWxseSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoX2RpZEl0ZXJhdG9yRXJyb3IpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aHJvdyBfaXRlcmF0b3JFcnJvcjtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBUcmlnZ2VyXG4gICAgICAgICAqIEBwYXJhbSBwYXJhbXNcbiAgICAgICAgICovXG5cbiAgICB9LCB7XG4gICAgICAgIGtleTogJ2hhbmRsZScsXG4gICAgICAgIHZhbHVlOiBmdW5jdGlvbiBoYW5kbGUocGFyYW1zKSB7fVxuICAgIH0sIHtcbiAgICAgICAga2V5OiAnZXZlbnROYW1lJyxcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7XG4gICAgICAgICAgICByZXR1cm4gJyc7XG4gICAgICAgIH1cbiAgICB9XSk7XG5cbiAgICByZXR1cm4gRXZlbnRJbnRlcmZhY2U7XG59KCk7XG5cbmV4cG9ydHMuRXZlbnRJbnRlcmZhY2UgPSBFdmVudEludGVyZmFjZTtcblxufSx7fV0sOTpbZnVuY3Rpb24ocmVxdWlyZSxtb2R1bGUsZXhwb3J0cyl7XG4ndXNlIHN0cmljdCc7XG5cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwge1xuICAgIHZhbHVlOiB0cnVlXG59KTtcbmV4cG9ydHMuU3VibWl0ID0gdW5kZWZpbmVkO1xuXG52YXIgX2NyZWF0ZUNsYXNzID0gZnVuY3Rpb24gKCkgeyBmdW5jdGlvbiBkZWZpbmVQcm9wZXJ0aWVzKHRhcmdldCwgcHJvcHMpIHsgZm9yICh2YXIgaSA9IDA7IGkgPCBwcm9wcy5sZW5ndGg7IGkrKykgeyB2YXIgZGVzY3JpcHRvciA9IHByb3BzW2ldOyBkZXNjcmlwdG9yLmVudW1lcmFibGUgPSBkZXNjcmlwdG9yLmVudW1lcmFibGUgfHwgZmFsc2U7IGRlc2NyaXB0b3IuY29uZmlndXJhYmxlID0gdHJ1ZTsgaWYgKFwidmFsdWVcIiBpbiBkZXNjcmlwdG9yKSBkZXNjcmlwdG9yLndyaXRhYmxlID0gdHJ1ZTsgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRhcmdldCwgZGVzY3JpcHRvci5rZXksIGRlc2NyaXB0b3IpOyB9IH0gcmV0dXJuIGZ1bmN0aW9uIChDb25zdHJ1Y3RvciwgcHJvdG9Qcm9wcywgc3RhdGljUHJvcHMpIHsgaWYgKHByb3RvUHJvcHMpIGRlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IucHJvdG90eXBlLCBwcm90b1Byb3BzKTsgaWYgKHN0YXRpY1Byb3BzKSBkZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLCBzdGF0aWNQcm9wcyk7IHJldHVybiBDb25zdHJ1Y3RvcjsgfTsgfSgpO1xuXG52YXIgX0V2ZW50SW50ZXJmYWNlMiA9IHJlcXVpcmUoJy4vRXZlbnRJbnRlcmZhY2UnKTtcblxuZnVuY3Rpb24gX2NsYXNzQ2FsbENoZWNrKGluc3RhbmNlLCBDb25zdHJ1Y3RvcikgeyBpZiAoIShpbnN0YW5jZSBpbnN0YW5jZW9mIENvbnN0cnVjdG9yKSkgeyB0aHJvdyBuZXcgVHlwZUVycm9yKFwiQ2Fubm90IGNhbGwgYSBjbGFzcyBhcyBhIGZ1bmN0aW9uXCIpOyB9IH1cblxuZnVuY3Rpb24gX3Bvc3NpYmxlQ29uc3RydWN0b3JSZXR1cm4oc2VsZiwgY2FsbCkgeyBpZiAoIXNlbGYpIHsgdGhyb3cgbmV3IFJlZmVyZW5jZUVycm9yKFwidGhpcyBoYXNuJ3QgYmVlbiBpbml0aWFsaXNlZCAtIHN1cGVyKCkgaGFzbid0IGJlZW4gY2FsbGVkXCIpOyB9IHJldHVybiBjYWxsICYmICh0eXBlb2YgY2FsbCA9PT0gXCJvYmplY3RcIiB8fCB0eXBlb2YgY2FsbCA9PT0gXCJmdW5jdGlvblwiKSA/IGNhbGwgOiBzZWxmOyB9XG5cbmZ1bmN0aW9uIF9pbmhlcml0cyhzdWJDbGFzcywgc3VwZXJDbGFzcykgeyBpZiAodHlwZW9mIHN1cGVyQ2xhc3MgIT09IFwiZnVuY3Rpb25cIiAmJiBzdXBlckNsYXNzICE9PSBudWxsKSB7IHRocm93IG5ldyBUeXBlRXJyb3IoXCJTdXBlciBleHByZXNzaW9uIG11c3QgZWl0aGVyIGJlIG51bGwgb3IgYSBmdW5jdGlvbiwgbm90IFwiICsgdHlwZW9mIHN1cGVyQ2xhc3MpOyB9IHN1YkNsYXNzLnByb3RvdHlwZSA9IE9iamVjdC5jcmVhdGUoc3VwZXJDbGFzcyAmJiBzdXBlckNsYXNzLnByb3RvdHlwZSwgeyBjb25zdHJ1Y3RvcjogeyB2YWx1ZTogc3ViQ2xhc3MsIGVudW1lcmFibGU6IGZhbHNlLCB3cml0YWJsZTogdHJ1ZSwgY29uZmlndXJhYmxlOiB0cnVlIH0gfSk7IGlmIChzdXBlckNsYXNzKSBPYmplY3Quc2V0UHJvdG90eXBlT2YgPyBPYmplY3Quc2V0UHJvdG90eXBlT2Yoc3ViQ2xhc3MsIHN1cGVyQ2xhc3MpIDogc3ViQ2xhc3MuX19wcm90b19fID0gc3VwZXJDbGFzczsgfVxuXG52YXIgU3VibWl0ID0gZnVuY3Rpb24gKF9FdmVudEludGVyZmFjZSkge1xuICAgIF9pbmhlcml0cyhTdWJtaXQsIF9FdmVudEludGVyZmFjZSk7XG5cbiAgICBmdW5jdGlvbiBTdWJtaXQoKSB7XG4gICAgICAgIF9jbGFzc0NhbGxDaGVjayh0aGlzLCBTdWJtaXQpO1xuXG4gICAgICAgIHJldHVybiBfcG9zc2libGVDb25zdHJ1Y3RvclJldHVybih0aGlzLCBPYmplY3QuZ2V0UHJvdG90eXBlT2YoU3VibWl0KS5hcHBseSh0aGlzLCBhcmd1bWVudHMpKTtcbiAgICB9XG5cbiAgICBfY3JlYXRlQ2xhc3MoU3VibWl0LCBbe1xuICAgICAgICBrZXk6ICdoYW5kbGUnLFxuXG5cbiAgICAgICAgLyoqXG4gICAgICAgICAqIEhhbmRsZXJcbiAgICAgICAgICogQHBhcmFtIGV2ZW50XG4gICAgICAgICAqL1xuICAgICAgICB2YWx1ZTogZnVuY3Rpb24gaGFuZGxlKGV2ZW50KSB7XG4gICAgICAgICAgICB2YXIgX2l0ZXJhdG9yTm9ybWFsQ29tcGxldGlvbiA9IHRydWU7XG4gICAgICAgICAgICB2YXIgX2RpZEl0ZXJhdG9yRXJyb3IgPSBmYWxzZTtcbiAgICAgICAgICAgIHZhciBfaXRlcmF0b3JFcnJvciA9IHVuZGVmaW5lZDtcblxuICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICBmb3IgKHZhciBfaXRlcmF0b3IgPSB0aGlzLmxvY2F0b3IuY291bnRlcnMudmFsdWVzKClbU3ltYm9sLml0ZXJhdG9yXSgpLCBfc3RlcDsgIShfaXRlcmF0b3JOb3JtYWxDb21wbGV0aW9uID0gKF9zdGVwID0gX2l0ZXJhdG9yLm5leHQoKSkuZG9uZSk7IF9pdGVyYXRvck5vcm1hbENvbXBsZXRpb24gPSB0cnVlKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBjb3VudGVyID0gX3N0ZXAudmFsdWU7XG5cbiAgICAgICAgICAgICAgICAgICAgY291bnRlci5zZW5kRXZlbnQoZXZlbnQsIHt9LCB7fSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSBjYXRjaCAoZXJyKSB7XG4gICAgICAgICAgICAgICAgX2RpZEl0ZXJhdG9yRXJyb3IgPSB0cnVlO1xuICAgICAgICAgICAgICAgIF9pdGVyYXRvckVycm9yID0gZXJyO1xuICAgICAgICAgICAgfSBmaW5hbGx5IHtcbiAgICAgICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgICAgICBpZiAoIV9pdGVyYXRvck5vcm1hbENvbXBsZXRpb24gJiYgX2l0ZXJhdG9yLnJldHVybikge1xuICAgICAgICAgICAgICAgICAgICAgICAgX2l0ZXJhdG9yLnJldHVybigpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSBmaW5hbGx5IHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKF9kaWRJdGVyYXRvckVycm9yKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aHJvdyBfaXRlcmF0b3JFcnJvcjtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH0sIHtcbiAgICAgICAga2V5OiAnZXZlbnROYW1lJyxcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7XG4gICAgICAgICAgICByZXR1cm4gJ3N1Ym1pdCc7XG4gICAgICAgIH1cbiAgICB9XSk7XG5cbiAgICByZXR1cm4gU3VibWl0O1xufShfRXZlbnRJbnRlcmZhY2UyLkV2ZW50SW50ZXJmYWNlKTtcblxuZXhwb3J0cy5TdWJtaXQgPSBTdWJtaXQ7XG5cbn0se1wiLi9FdmVudEludGVyZmFjZVwiOjh9XX0se30sWzJdKVxuXG4iLCJsZXQgaW5zdGFuY2UgPSBudWxsO1xuXG5jbGFzcyBVbmlvbkFuYWx5dGljcyB7XG4gICAgLyoqXG4gICAgICogU2luZ2xldG9uXG4gICAgICogQHJldHVybiB7Kn1cbiAgICAgKi9cbiAgICBjb25zdHJ1Y3RvcigpIHtcbiAgICAgICAgaWYgKG51bGwgPT09IGluc3RhbmNlIHx8IChmYWxzZSA9PT0gaW5zdGFuY2UgaW5zdGFuY2VvZiB0aGlzKSkge1xuICAgICAgICAgICAgdGhpcy5jb3VudGVycyA9IG5ldyBNYXAoKTtcbiAgICAgICAgICAgIHRoaXMuZXZlbnRzID0gbmV3IE1hcCgpO1xuICAgICAgICAgICAgdGhpcy5tb2R1bGVNYXAgPSBuZXcgTWFwKCk7XG4gICAgICAgICAgICBpbnN0YW5jZSA9IHRoaXM7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBBZGQgbW9kdWxlXG4gICAgICogQHBhcmFtIGpzTW9kdWxlXG4gICAgICogQHBhcmFtIGpzT2JqZWN0XG4gICAgICogQHJldHVybiB7VW5pb25BbmFseXRpY3N9XG4gICAgICovXG4gICAgYWRkTW9kdWxlKGpzTW9kdWxlLCBqc09iamVjdCkge1xuICAgICAgICB0aGlzLm1vZHVsZU1hcC5zZXQoanNNb2R1bGUsIGpzT2JqZWN0KTtcblxuICAgICAgICByZXR1cm4gdGhpcztcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBBZGQgY291bnRlclxuICAgICAqIEBwYXJhbSBpZFxuICAgICAqIEBwYXJhbSBqc01vZHVsZVxuICAgICAqIEBwYXJhbSBqc09iamVjdFxuICAgICAqIEBwYXJhbSBvcHRpb25zXG4gICAgICogQHJldHVybiB7VW5pb25BbmFseXRpY3N9XG4gICAgICovXG4gICAgYWRkQ291bnRlcih7aWQsIGpzTW9kdWxlLCBqc09iamVjdCwgb3B0aW9ucyA9IHt9fSkge1xuICAgICAgICBpZiAoIXRoaXMubW9kdWxlTWFwLmhhcyhqc01vZHVsZSkpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzO1xuICAgICAgICB9XG4gICAgICAgIGpzTW9kdWxlID0gdGhpcy5tb2R1bGVNYXAuZ2V0KGpzTW9kdWxlKTtcbiAgICAgICAgdGhpcy5jb3VudGVycy5zZXQoaWQsIG5ldyBqc01vZHVsZSh0aGlzLCBqc09iamVjdCwgb3B0aW9ucykpO1xuXG4gICAgICAgIHJldHVybiB0aGlzO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEFkZCBldmVudFxuICAgICAqIEBwYXJhbSBqc01vZHVsZVxuICAgICAqIEBwYXJhbSB0eXBlXG4gICAgICogQHBhcmFtIG9wdGlvbnNcbiAgICAgKiBAcmV0dXJuIHtVbmlvbkFuYWx5dGljc31cbiAgICAgKi9cbiAgICBhZGRFdmVudCh7anNNb2R1bGUsIHR5cGUsIG9wdGlvbnMgPSB7fX0pIHtcbiAgICAgICAgaWYgKCF0aGlzLm1vZHVsZU1hcC5oYXMoanNNb2R1bGUpKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcztcbiAgICAgICAgfVxuICAgICAgICBqc01vZHVsZSA9IHRoaXMubW9kdWxlTWFwLmdldChqc01vZHVsZSk7XG5cbiAgICAgICAgbGV0IF9hcnJheSA9IHRoaXMuZXZlbnRzLmhhcyh0eXBlKSA/IHRoaXMuZXZlbnRzLmdldCh0eXBlKSA6IFtdO1xuICAgICAgICBfYXJyYXkucHVzaChuZXcganNNb2R1bGUodGhpcywgb3B0aW9ucykpO1xuICAgICAgICB0aGlzLmV2ZW50cy5zZXQodHlwZSwgX2FycmF5KTtcblxuICAgICAgICByZXR1cm4gdGhpcztcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBBZGQgY291bnRlcnNcbiAgICAgKiBAcGFyYW0gY291bnRlcnNBcnJheVxuICAgICAqIEByZXR1cm4ge1VuaW9uQW5hbHl0aWNzfVxuICAgICAqL1xuICAgIGFkZENvdW50ZXJzKGNvdW50ZXJzQXJyYXkpIHtcbiAgICAgICAgZm9yIChsZXQgY291bnRlciBvZiBjb3VudGVyc0FycmF5KSB7XG4gICAgICAgICAgICB0aGlzLmFkZENvdW50ZXIoY291bnRlcik7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQWRkIGV2ZW50c1xuICAgICAqIEBwYXJhbSBldmVudHNcbiAgICAgKiBAcmV0dXJuIHtVbmlvbkFuYWx5dGljc31cbiAgICAgKi9cbiAgICBhZGRFdmVudHMoZXZlbnRzKSB7XG4gICAgICAgIGZvciAobGV0IGV2ZW50IG9mIGV2ZW50cykge1xuICAgICAgICAgICAgdGhpcy5hZGRFdmVudChldmVudCk7XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gdGhpcztcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBUcmlnZ2VyIGFuIGV2ZW50XG4gICAgICogQHBhcmFtIHR5cGVcbiAgICAgKiBAcGFyYW0gcGFyYW1zXG4gICAgICogQHJldHVybiB7VW5pb25BbmFseXRpY3N9XG4gICAgICovXG4gICAgdHJpZ2dlcih0eXBlLCBwYXJhbXMpIHtcbiAgICAgICAgbGV0IF9hcnJheSA9IHRoaXMuZXZlbnRzLmhhcyh0eXBlKSA/IHRoaXMuZXZlbnRzLmdldCh0eXBlKSA6IFtdO1xuICAgICAgICBmb3IgKGxldCBldmVudCBvZiBfYXJyYXkpIHtcbiAgICAgICAgICAgIGV2ZW50LnRyaWdnZXIocGFyYW1zKTtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiB0aGlzO1xuICAgIH1cbn1cblxuZXhwb3J0IHtVbmlvbkFuYWx5dGljc307XG4iLCIvL2ltcG9ydCB7SW50ZW50QW5hbHl0aWNzfSBmcm9tICcuL0ludGVudEFuYWx5dGljcyc7XG5pbXBvcnQge1VuaW9uQW5hbHl0aWNzfSBmcm9tICcuL1VuaW9uQW5hbHl0aWNzJztcblxuaW1wb3J0IHtDb3VudGVyR29vZ2xlQW5hbHl0aWNzfSBmcm9tICcuL2NvdW50ZXJzL0NvdW50ZXJHb29nbGVBbmFseXRpY3MnO1xuaW1wb3J0IHtDb3VudGVyWWFuZGV4TWV0cmlrYX0gZnJvbSAnLi9jb3VudGVycy9Db3VudGVyWWFuZGV4TWV0cmlrYSc7XG5pbXBvcnQge0NvdW50ZXJQaXdpa30gZnJvbSAnLi9jb3VudGVycy9Db3VudGVyUGl3aWsnO1xuaW1wb3J0IHtDbGlja30gZnJvbSAnLi9ldmVudHMvQ2xpY2snO1xuaW1wb3J0IHtTdWJtaXR9IGZyb20gJy4vZXZlbnRzL1N1Ym1pdCc7XG5cbmxldCB1YSA9IG5ldyBVbmlvbkFuYWx5dGljcygpO1xudWEuYWRkTW9kdWxlKCdDb3VudGVyR29vZ2xlQW5hbHl0aWNzJywgQ291bnRlckdvb2dsZUFuYWx5dGljcyk7XG51YS5hZGRNb2R1bGUoJ0NvdW50ZXJZYW5kZXhNZXRyaWthJywgQ291bnRlcllhbmRleE1ldHJpa2EpO1xudWEuYWRkTW9kdWxlKCdDb3VudGVyUGl3aWsnLCBDb3VudGVyUGl3aWspO1xudWEuYWRkTW9kdWxlKCdDbGljaycsIENsaWNrKTtcbnVhLmFkZE1vZHVsZSgnU3VibWl0JywgU3VibWl0KTtcblxuLy9nbG9iYWwuaW50ZW50QW5hbHl0aWNzID0gbmV3IEludGVudEFuYWx5dGljcygpO1xuZ2xvYmFsLlVuaW9uQW5hbHl0aWNzID0gdWE7XG4iLCJpbXBvcnQge0NvdW50ZXJJbnRlcmZhY2V9IGZyb20gJy4vQ291bnRlckludGVyZmFjZSc7XG5cbmNsYXNzIENvdW50ZXJHb29nbGVBbmFseXRpY3MgZXh0ZW5kcyBDb3VudGVySW50ZXJmYWNlIHtcbiAgICAvKipcbiAgICAgKiBAcGFyYW0gb3B0aW9uc1xuICAgICAqL1xuICAgIGluaXQob3B0aW9ucykge1xuICAgICAgICBzdXBlci5pbml0KG9wdGlvbnMpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEBwYXJhbSBuYW1lXG4gICAgICogQHJldHVybiB7e319XG4gICAgICovXG4gICAgcmVzb2x2ZUpzT2JqZWN0KG5hbWUpIHtcbiAgICAgICAgcmV0dXJuIHdpbmRvd1tuYW1lXSB8fCBzdXBlci5yZXNvbHZlSnNPYmplY3QobmFtZSk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQHBhcmFtIGV2ZW50XG4gICAgICogQHBhcmFtIGRhdGFcbiAgICAgKiBAcGFyYW0gcGFyYW1zXG4gICAgICovXG4gICAgc2VuZEV2ZW50KGV2ZW50LCBkYXRhLCBwYXJhbXMpIHtcbiAgICAgICAgLy8gdGhpcy5qc09iamVjdCgnc2VuZCcsICdldmVudCcsICk7XG4gICAgfVxufVxuXG5leHBvcnQge0NvdW50ZXJHb29nbGVBbmFseXRpY3N9O1xuIiwiY2xhc3MgQ291bnRlckludGVyZmFjZSB7XG4gICAgLyoqXG4gICAgICogQHBhcmFtIGxvY2F0b3JcbiAgICAgKiBAcGFyYW0ganNPYmplY3RcbiAgICAgKiBAcGFyYW0gb3B0aW9uc1xuICAgICAqL1xuICAgIGNvbnN0cnVjdG9yKGxvY2F0b3IsIGpzT2JqZWN0LCBvcHRpb25zKSB7XG4gICAgICAgIHRoaXMubG9jYXRvciA9IGxvY2F0b3I7XG4gICAgICAgIHRoaXMuanNPYmplY3QgPSB0aGlzLnJlc29sdmVKc09iamVjdChqc09iamVjdCk7XG4gICAgICAgIHRoaXMucmF3T3B0aW9ucyA9IG9wdGlvbnM7XG4gICAgICAgIHRoaXMuaW5pdChvcHRpb25zKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBJbml0XG4gICAgICogQHBhcmFtIG9wdGlvbnNcbiAgICAgKi9cbiAgICBpbml0KG9wdGlvbnMpIHtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBAcGFyYW0gbmFtZVxuICAgICAqIEByZXR1cm4ge3t9fVxuICAgICAqL1xuICAgIHJlc29sdmVKc09iamVjdChuYW1lKSB7XG4gICAgICAgIHJldHVybiB7fTtcbiAgICB9XG4gICAgXG4gICAgLyoqXG4gICAgICogU2VuZCBldmVudFxuICAgICAqIEBwYXJhbSBldmVudFxuICAgICAqIEBwYXJhbSBkYXRhXG4gICAgICogQHBhcmFtIHBhcmFtc1xuICAgICAqL1xuICAgIHNlbmRFdmVudChldmVudCwgZGF0YSwgcGFyYW1zKSB7XG4gICAgfVxufVxuXG5leHBvcnQge0NvdW50ZXJJbnRlcmZhY2V9O1xuIiwiaW1wb3J0IHtDb3VudGVySW50ZXJmYWNlfSBmcm9tICcuL0NvdW50ZXJJbnRlcmZhY2UnO1xuXG5jbGFzcyBDb3VudGVyUGl3aWsgZXh0ZW5kcyBDb3VudGVySW50ZXJmYWNlIHtcbiAgICAvKipcbiAgICAgKiBAcGFyYW0gb3B0aW9uc1xuICAgICAqL1xuICAgIGluaXQob3B0aW9ucykge1xuICAgICAgICBzdXBlci5pbml0KG9wdGlvbnMpO1xuICAgIH1cblxuXG4gICAgLyoqXG4gICAgICogQHBhcmFtIG5hbWVcbiAgICAgKiBAcmV0dXJuIHt7fX1cbiAgICAgKi9cbiAgICByZXNvbHZlSnNPYmplY3QobmFtZSkge1xuICAgICAgICByZXR1cm4gd2luZG93W25hbWVdIHx8IHN1cGVyLnJlc29sdmVKc09iamVjdChuYW1lKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBAcGFyYW0gZXZlbnRcbiAgICAgKiBAcGFyYW0gZGF0YVxuICAgICAqIEBwYXJhbSBwYXJhbXNcbiAgICAgKi9cbiAgICBzZW5kRXZlbnQoZXZlbnQsIGRhdGEsIHBhcmFtcykge1xuICAgIH1cbn1cblxuZXhwb3J0IHtDb3VudGVyUGl3aWt9O1xuIiwiaW1wb3J0IHtDb3VudGVySW50ZXJmYWNlfSBmcm9tICcuL0NvdW50ZXJJbnRlcmZhY2UnO1xuXG5jbGFzcyBDb3VudGVyWWFuZGV4TWV0cmlrYSBleHRlbmRzIENvdW50ZXJJbnRlcmZhY2Uge1xuICAgIC8qKlxuICAgICAqIEBwYXJhbSBvcHRpb25zXG4gICAgICovXG4gICAgaW5pdChvcHRpb25zKSB7XG4gICAgICAgIHN1cGVyLmluaXQob3B0aW9ucyk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQHBhcmFtIG5hbWVcbiAgICAgKiBAcmV0dXJuIHt7fX1cbiAgICAgKi9cbiAgICByZXNvbHZlSnNPYmplY3QobmFtZSkge1xuICAgICAgICByZXR1cm4gd2luZG93W2B5YUNvdW50ZXIke25hbWV9YF0gfHwgc3VwZXIucmVzb2x2ZUpzT2JqZWN0KG5hbWUpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEBwYXJhbSBldmVudFxuICAgICAqIEBwYXJhbSBkYXRhXG4gICAgICogQHBhcmFtIHBhcmFtc1xuICAgICAqL1xuICAgIHNlbmRFdmVudChldmVudCwgZGF0YSwgcGFyYW1zKSB7XG4gICAgICAgIGNvbnNvbGUubG9nKGV2ZW50KTtcbiAgICAgICAgLy90aGlzLmpzT2JqZWN0LnJlYWNoR29hbChldmVudCwgcGFyYW1zIHx8IHt9KTtcbiAgICB9XG59XG5cbmV4cG9ydCB7Q291bnRlcllhbmRleE1ldHJpa2F9O1xuIiwiaW1wb3J0IHtFdmVudEludGVyZmFjZX0gZnJvbSAnLi9FdmVudEludGVyZmFjZSc7XG5cbmNsYXNzIENsaWNrIGV4dGVuZHMgRXZlbnRJbnRlcmZhY2Uge1xuXG4gICAgZ2V0IGV2ZW50TmFtZSAoKSB7XG4gICAgICAgIHJldHVybiAnY2xpY2snO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEhhbmRsZXJcbiAgICAgKiBAcGFyYW0gZXZlbnRcbiAgICAgKi9cbiAgICBoYW5kbGUoZXZlbnQpIHtcbiAgICAgICAgZm9yIChsZXQgY291bnRlciBvZiB0aGlzLmxvY2F0b3IuY291bnRlcnMudmFsdWVzKCkpIHtcbiAgICAgICAgICAgIGNvdW50ZXIuc2VuZEV2ZW50KGV2ZW50LCB7fSwge30pO1xuICAgICAgICB9XG4gICAgfVxufVxuXG5leHBvcnQge0NsaWNrfTtcbiIsImNsYXNzIEV2ZW50SW50ZXJmYWNlIHtcblxuICAgIC8qKlxuICAgICAqIEBwYXJhbSBsb2NhdG9yIFVuaW9uQW5hbHl0aWNzXG4gICAgICogQHBhcmFtIG9wdGlvbnNcbiAgICAgKi9cbiAgICBjb25zdHJ1Y3Rvcihsb2NhdG9yLCBvcHRpb25zKSB7XG4gICAgICAgIHRoaXMubG9jYXRvciA9IGxvY2F0b3I7XG4gICAgICAgIHRoaXMuaW5pdChvcHRpb25zKTtcbiAgICAgICAgdGhpcy5hdHRhY2hIYW5kbGVycyhvcHRpb25zKTtcbiAgICB9XG5cbiAgICBnZXQgZXZlbnROYW1lKCkge1xuICAgICAgICByZXR1cm4gJyc7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogSW5pdFxuICAgICAqIEBwYXJhbSBvcHRpb25zXG4gICAgICovXG4gICAgaW5pdChvcHRpb25zKSB7XG5cbiAgICB9XG5cbiAgICBhdHRhY2hIYW5kbGVycyhvcHRpb25zKSB7XG4gICAgICAgIGNvbnN0IGhhcyA9IE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHk7XG4gICAgICAgIGlmIChvcHRpb25zICE9PSBudWxsICYmIGhhcy5jYWxsKG9wdGlvbnMsICdzZWxlY3RvcnMnKSkge1xuICAgICAgICAgICAgZm9yIChjb25zdCBzZWxlY3RvciBvZiBvcHRpb25zLnNlbGVjdG9ycykge1xuICAgICAgICAgICAgICAgIGNvbnN0IGVsZW1lbnRzID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChzZWxlY3Rvcik7XG4gICAgICAgICAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBlbGVtZW50cy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgICAgICAgICBlbGVtZW50c1tpXS5hZGRFdmVudExpc3RlbmVyKHRoaXMuZXZlbnROYW1lLCAoZXZlbnQpID0+IHRoaXMuaGFuZGxlKGV2ZW50KSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogVHJpZ2dlclxuICAgICAqIEBwYXJhbSBwYXJhbXNcbiAgICAgKi9cbiAgICBoYW5kbGUocGFyYW1zKSB7XG4gICAgfVxufVxuXG5leHBvcnQge0V2ZW50SW50ZXJmYWNlfTtcbiIsImltcG9ydCB7RXZlbnRJbnRlcmZhY2V9IGZyb20gJy4vRXZlbnRJbnRlcmZhY2UnO1xuXG5jbGFzcyBTdWJtaXQgZXh0ZW5kcyBFdmVudEludGVyZmFjZSB7XG5cbiAgICBnZXQgZXZlbnROYW1lICgpIHtcbiAgICAgICAgcmV0dXJuICdzdWJtaXQnO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEhhbmRsZXJcbiAgICAgKiBAcGFyYW0gZXZlbnRcbiAgICAgKi9cbiAgICBoYW5kbGUoZXZlbnQpIHtcbiAgICAgICAgZm9yIChsZXQgY291bnRlciBvZiB0aGlzLmxvY2F0b3IuY291bnRlcnMudmFsdWVzKCkpIHtcbiAgICAgICAgICAgIGNvdW50ZXIuc2VuZEV2ZW50KGV2ZW50LCB7fSwge30pO1xuICAgICAgICB9XG4gICAgfVxufVxuXG5leHBvcnQge1N1Ym1pdH07XG4iXSwic291cmNlUm9vdCI6Ii9zb3VyY2UvIn0=
